{"episode_reward_max": -394.5580755468562, "episode_reward_min": -43411.57792712663, "episode_reward_mean": -6483.982705298982, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7346.711427269884, "mean_processing_ms": 506.564471852127, "mean_inference_ms": 2.7331161261791026}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1551, "num_steps_sampled": 1600, "sample_time_ms": 1668700.354, "load_time_ms": 256.746, "grad_time_ms": 1730.5, "update_time_ms": 3188.93, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 11330496.0, "policy_loss": -0.057479068636894226, "vf_loss": 11330496.0, "vf_explained_var": 0.00023359060287475586, "kl": 0.011523070745170116, "entropy": 23.925947189331055, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 1600, "episodes_total": 32, "training_iteration": 1, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-25_22-36-30", "timestamp": 1619361390, "time_this_iter_s": 1674.1153967380524, "time_total_s": 1674.1153967380524, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1674.1153967380524, "timesteps_since_restore": 1600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 80.66990372540813, "ram_util_percent": 52.60393470071159}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.2787196896018, "episode_reward_min": -43411.57792712663, "episode_reward_mean": -3647.704287240339, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7168.953652467739, "mean_processing_ms": 534.1229359584713, "mean_inference_ms": 2.5696537381988813}, "off_policy_estimator": {}, "info": {"num_steps_trained": 3102, "num_steps_sampled": 3200, "sample_time_ms": 1597253.635, "load_time_ms": 134.611, "grad_time_ms": 1211.174, "update_time_ms": 1599.224, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 49944.30078125, "policy_loss": -0.13062380254268646, "vf_loss": 49944.42578125, "vf_explained_var": 0.010284586809575558, "kl": 0.03666435182094574, "entropy": 23.88947296142578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 3200, "episodes_total": 64, "training_iteration": 2, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-25_23-01-56", "timestamp": 1619362916, "time_this_iter_s": 1526.5397775173187, "time_total_s": 3200.655174255371, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3200.655174255371, "timesteps_since_restore": 3200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 83.31920073495634, "ram_util_percent": 57.26871841984382}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.2787196896018, "episode_reward_min": -43411.57792712663, "episode_reward_mean": -2688.690181469706, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7080.255268254518, "mean_processing_ms": 549.424638525671, "mean_inference_ms": 2.481693344940892}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4653, "num_steps_sampled": 4800, "sample_time_ms": 1574315.966, "load_time_ms": 96.12, "grad_time_ms": 1038.575, "update_time_ms": 1070.046, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 49379.4765625, "policy_loss": -0.12934266030788422, "vf_loss": 49379.59765625, "vf_explained_var": 0.015009419061243534, "kl": 0.03853478282690048, "entropy": 23.855344772338867, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 4800, "episodes_total": 96, "training_iteration": 3, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-25_23-27-25", "timestamp": 1619364445, "time_this_iter_s": 1529.1802875995636, "time_total_s": 4729.835461854935, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4729.835461854935, "timesteps_since_restore": 4800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 84.44823475469967, "ram_util_percent": 58.78578633654286}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.2787196896018, "episode_reward_min": -1343.5639411878535, "episode_reward_mean": -823.3473324045656, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6933.031504510357, "mean_processing_ms": 591.1108999456682, "mean_inference_ms": 2.30946000149513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6204, "num_steps_sampled": 6400, "sample_time_ms": 1586466.361, "load_time_ms": 74.66, "grad_time_ms": 941.164, "update_time_ms": 805.513, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 56757.515625, "policy_loss": -0.13349603116512299, "vf_loss": 56757.63671875, "vf_explained_var": 0.01968364231288433, "kl": 0.03776490315794945, "entropy": 23.81153106689453, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 6400, "episodes_total": 136, "training_iteration": 4, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-25_23-54-29", "timestamp": 1619366069, "time_this_iter_s": 1623.6010558605194, "time_total_s": 6353.436517715454, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6353.436517715454, "timesteps_since_restore": 6400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 83.94537996545769, "ram_util_percent": 60.02664075993092}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.12349203172806, "episode_reward_min": -1311.9472655563995, "episode_reward_mean": -852.9977122021373, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6957.984836644468, "mean_processing_ms": 607.3264134797247, "mean_inference_ms": 2.249426470238603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7755, "num_steps_sampled": 8000, "sample_time_ms": 1609999.172, "load_time_ms": 61.776, "grad_time_ms": 882.102, "update_time_ms": 646.055, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 73401.0078125, "policy_loss": -0.14122125506401062, "vf_loss": 73401.140625, "vf_explained_var": 0.022665197029709816, "kl": 0.04513702169060707, "entropy": 23.763774871826172, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 8000, "episodes_total": 168, "training_iteration": 5, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_00-22-54", "timestamp": 1619367774, "time_this_iter_s": 1704.8102178573608, "time_total_s": 8058.246735572815, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8058.246735572815, "timesteps_since_restore": 8000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 84.89839572192513, "ram_util_percent": 61.34594816947758}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.12349203172806, "episode_reward_min": -1311.9472655563995, "episode_reward_mean": -882.826337553868, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7008.144598818899, "mean_processing_ms": 618.198756381659, "mean_inference_ms": 2.2140822211208926}, "off_policy_estimator": {}, "info": {"num_steps_trained": 9306, "num_steps_sampled": 9600, "sample_time_ms": 1622926.395, "load_time_ms": 53.494, "grad_time_ms": 874.341, "update_time_ms": 539.96, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 314371.6875, "policy_loss": -0.07340463250875473, "vf_loss": 314371.78125, "vf_explained_var": 0.015646440908312798, "kl": 0.024116836488246918, "entropy": 23.7313232421875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 9600, "episodes_total": 200, "training_iteration": 6, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_00-51-02", "timestamp": 1619369462, "time_this_iter_s": 1688.439391374588, "time_total_s": 9746.686126947403, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9746.686126947403, "timesteps_since_restore": 9600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 80.90755813953488, "ram_util_percent": 62.53334717607973}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.12349203172806, "episode_reward_min": -12032.008988802481, "episode_reward_mean": -960.9886005380337, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7050.731532581765, "mean_processing_ms": 621.0373152693895, "mean_inference_ms": 2.192979404068199}, "off_policy_estimator": {}, "info": {"num_steps_trained": 10857, "num_steps_sampled": 11200, "sample_time_ms": 1621422.332, "load_time_ms": 47.679, "grad_time_ms": 850.124, "update_time_ms": 465.571, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 73897.609375, "policy_loss": -0.1278153955936432, "vf_loss": 73897.71875, "vf_explained_var": 0.030498288571834564, "kl": 0.036132145673036575, "entropy": 23.693634033203125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 11200, "episodes_total": 232, "training_iteration": 7, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_01-17-56", "timestamp": 1619371076, "time_this_iter_s": 1613.1542973518372, "time_total_s": 11359.84042429924, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11359.84042429924, "timesteps_since_restore": 11200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.05336810082572, "ram_util_percent": 63.62225119513255}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.5403548850176, "episode_reward_min": -155160.54800956591, "episode_reward_mean": -2502.530522841266, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7097.455483788875, "mean_processing_ms": 626.7979743531846, "mean_inference_ms": 2.1800089122798227}, "off_policy_estimator": {}, "info": {"num_steps_trained": 12408, "num_steps_sampled": 12800, "sample_time_ms": 1789710.513, "load_time_ms": 43.275, "grad_time_ms": 828.545, "update_time_ms": 408.984, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 104473296.0, "policy_loss": -0.06379736959934235, "vf_loss": 104473296.0, "vf_explained_var": 0.0006400780403055251, "kl": 0.017908554524183273, "entropy": 23.6693115234375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 12800, "episodes_total": 272, "training_iteration": 8, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_02-07-24", "timestamp": 1619374044, "time_this_iter_s": 2968.448320865631, "time_total_s": 14328.288745164871, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14328.288745164871, "timesteps_since_restore": 12800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.68485707536026, "ram_util_percent": 65.2330498464446}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.5403548850176, "episode_reward_min": -155160.54800956591, "episode_reward_mean": -2480.056748595643, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7136.225093827896, "mean_processing_ms": 632.1446747067046, "mean_inference_ms": 2.1728877974236616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13959, "num_steps_sampled": 14400, "sample_time_ms": 1775490.791, "load_time_ms": 39.812, "grad_time_ms": 808.64, "update_time_ms": 364.809, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 59549.546875, "policy_loss": -0.12913136184215546, "vf_loss": 59549.6640625, "vf_explained_var": 0.06334319710731506, "kl": 0.03601488843560219, "entropy": 23.63743782043457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 14400, "episodes_total": 304, "training_iteration": 9, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_02-35-07", "timestamp": 1619375707, "time_this_iter_s": 1662.4249715805054, "time_total_s": 15990.713716745377, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15990.713716745377, "timesteps_since_restore": 14400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 85.64188106284269, "ram_util_percent": 65.64078447912273}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.5403548850176, "episode_reward_min": -155160.54800956591, "episode_reward_mean": -2416.7926324250775, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7179.075497871943, "mean_processing_ms": 634.4345011470986, "mean_inference_ms": 2.1661485737576665}, "off_policy_estimator": {}, "info": {"num_steps_trained": 15510, "num_steps_sampled": 16000, "sample_time_ms": 1759917.34, "load_time_ms": 37.07, "grad_time_ms": 795.406, "update_time_ms": 329.795, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 61440.5, "policy_loss": -0.1279120296239853, "vf_loss": 61440.609375, "vf_explained_var": 0.06148344650864601, "kl": 0.03200644254684448, "entropy": 23.607511520385742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 16000, "episodes_total": 336, "training_iteration": 10, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_03-02-07", "timestamp": 1619377327, "time_this_iter_s": 1620.4789407253265, "time_total_s": 17611.192657470703, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17611.192657470703, "timesteps_since_restore": 16000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.7160969277369, "ram_util_percent": 66.2593249675465}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.8494184697834, "episode_reward_min": -1239.5862445147266, "episode_reward_mean": -844.6458112903168, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7172.0534547975585, "mean_processing_ms": 633.8305851082723, "mean_inference_ms": 2.156551720891709}, "off_policy_estimator": {}, "info": {"num_steps_trained": 17061, "num_steps_sampled": 17600, "sample_time_ms": 1749397.236, "load_time_ms": 12.538, "grad_time_ms": 688.226, "update_time_ms": 12.093, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 50267.23828125, "policy_loss": -0.12035583704710007, "vf_loss": 50267.3515625, "vf_explained_var": 0.06526350229978561, "kl": 0.029265809804201126, "entropy": 23.587505340576172, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 17600, "episodes_total": 368, "training_iteration": 11, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_03-28-11", "timestamp": 1619378891, "time_this_iter_s": 1564.1984221935272, "time_total_s": 19175.39107966423, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19175.39107966423, "timesteps_since_restore": 17600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 84.78462572837293, "ram_util_percent": 67.05244285073958}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.76106189801203, "episode_reward_min": -1325.000573965905, "episode_reward_mean": -814.0753291216423, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7161.453016393893, "mean_processing_ms": 637.1021805698863, "mean_inference_ms": 2.147517904672101}, "off_policy_estimator": {}, "info": {"num_steps_trained": 18612, "num_steps_sampled": 19200, "sample_time_ms": 1763244.599, "load_time_ms": 12.494, "grad_time_ms": 693.247, "update_time_ms": 11.939, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 41661.18359375, "policy_loss": -0.1204226016998291, "vf_loss": 41661.29296875, "vf_explained_var": 0.07729171216487885, "kl": 0.034102316945791245, "entropy": 23.54816436767578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 19200, "episodes_total": 408, "training_iteration": 12, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_03-55-56", "timestamp": 1619380556, "time_this_iter_s": 1665.0649135112762, "time_total_s": 20840.455993175507, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20840.455993175507, "timesteps_since_restore": 19200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 82.79696842105263, "ram_util_percent": 67.8973894736842}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.2441485694469, "episode_reward_min": -1325.000573965905, "episode_reward_mean": -766.8686184599579, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7153.340055386864, "mean_processing_ms": 642.0477766529301, "mean_inference_ms": 2.1418224446049394}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20163, "num_steps_sampled": 20800, "sample_time_ms": 1777258.307, "load_time_ms": 11.615, "grad_time_ms": 694.659, "update_time_ms": 12.032, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 109071.7578125, "policy_loss": -0.102045439183712, "vf_loss": 109071.8515625, "vf_explained_var": 0.058492694050073624, "kl": 0.028249917551875114, "entropy": 23.52037811279297, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 20800, "episodes_total": 440, "training_iteration": 13, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_04-23-46", "timestamp": 1619382226, "time_this_iter_s": 1669.3310792446136, "time_total_s": 22509.78707242012, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22509.78707242012, "timesteps_since_restore": 20800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 84.59517009659805, "ram_util_percent": 68.94729105417892}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.2441485694469, "episode_reward_min": -4892.396073378549, "episode_reward_mean": -861.760456917321, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7156.459711295628, "mean_processing_ms": 645.9784409855515, "mean_inference_ms": 2.137647872133611}, "off_policy_estimator": {}, "info": {"num_steps_trained": 21714, "num_steps_sampled": 22400, "sample_time_ms": 1779308.893, "load_time_ms": 11.831, "grad_time_ms": 696.919, "update_time_ms": 11.832, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 59970.421875, "policy_loss": -0.12748673558235168, "vf_loss": 59970.5390625, "vf_explained_var": 0.06695625185966492, "kl": 0.030785422772169113, "entropy": 23.492673873901367, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 22400, "episodes_total": 472, "training_iteration": 14, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_04-51-10", "timestamp": 1619383870, "time_this_iter_s": 1644.1375269889832, "time_total_s": 24153.924599409103, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24153.924599409103, "timesteps_since_restore": 22400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 84.38797441364605, "ram_util_percent": 69.92827292110874}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.2441485694469, "episode_reward_min": -4892.396073378549, "episode_reward_mean": -876.8073357578512, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7158.8224706713345, "mean_processing_ms": 646.3466958018065, "mean_inference_ms": 2.1336980703505635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 23265, "num_steps_sampled": 24000, "sample_time_ms": 1774033.817, "load_time_ms": 12.082, "grad_time_ms": 709.324, "update_time_ms": 11.9, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 61282.52734375, "policy_loss": -0.13364610075950623, "vf_loss": 61282.6484375, "vf_explained_var": 0.07191654294729233, "kl": 0.03251783549785614, "entropy": 23.459821701049805, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 24000, "episodes_total": 504, "training_iteration": 15, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_05-18-42", "timestamp": 1619385522, "time_this_iter_s": 1652.186796426773, "time_total_s": 25806.111395835876, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25806.111395835876, "timesteps_since_restore": 24000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 84.89859932088285, "ram_util_percent": 70.71073853989813}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.17412895836566, "episode_reward_min": -4892.396073378549, "episode_reward_mean": -985.706146491713, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7183.544994870263, "mean_processing_ms": 647.1644255884474, "mean_inference_ms": 2.129881090433389}, "off_policy_estimator": {}, "info": {"num_steps_trained": 24816, "num_steps_sampled": 25600, "sample_time_ms": 1781984.951, "load_time_ms": 12.476, "grad_time_ms": 699.892, "update_time_ms": 11.704, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 113813.4921875, "policy_loss": -0.11353326588869095, "vf_loss": 113813.578125, "vf_explained_var": 0.06116289272904396, "kl": 0.030618613585829735, "entropy": 23.40765953063965, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 25600, "episodes_total": 544, "training_iteration": 16, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_05-48-10", "timestamp": 1619387290, "time_this_iter_s": 1767.8604397773743, "time_total_s": 27573.97183561325, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27573.97183561325, "timesteps_since_restore": 25600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 84.51126090404442, "ram_util_percent": 71.43739095955591}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.17412895836566, "episode_reward_min": -4732.668219050555, "episode_reward_mean": -954.1305103853474, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7204.843971917157, "mean_processing_ms": 648.9472875656893, "mean_inference_ms": 2.1272454604718005}, "off_policy_estimator": {}, "info": {"num_steps_trained": 26367, "num_steps_sampled": 27200, "sample_time_ms": 1792146.148, "load_time_ms": 12.496, "grad_time_ms": 703.303, "update_time_ms": 11.289, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 63411.375, "policy_loss": -0.1370781511068344, "vf_loss": 63411.5, "vf_explained_var": 0.075705386698246, "kl": 0.035232849419116974, "entropy": 23.375185012817383, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 27200, "episodes_total": 576, "training_iteration": 17, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_06-16-45", "timestamp": 1619389005, "time_this_iter_s": 1714.7947478294373, "time_total_s": 29288.766583442688, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29288.766583442688, "timesteps_since_restore": 27200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 85.29640228945216, "ram_util_percent": 72.16905151267375}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.17412895836566, "episode_reward_min": -156239.99242029167, "episode_reward_mean": -2467.6604593621696, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7235.147734176506, "mean_processing_ms": 651.1227773449373, "mean_inference_ms": 2.1257047922855445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27918, "num_steps_sampled": 28800, "sample_time_ms": 1780686.898, "load_time_ms": 12.465, "grad_time_ms": 700.106, "update_time_ms": 11.092, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 112895416.0, "policy_loss": -0.06149757280945778, "vf_loss": 112895416.0, "vf_explained_var": 0.0011256391881033778, "kl": 0.018964646384119987, "entropy": 23.352245330810547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 28800, "episodes_total": 608, "training_iteration": 18, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_07-04-19", "timestamp": 1619391859, "time_this_iter_s": 2853.828489780426, "time_total_s": 32142.595073223114, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32142.595073223114, "timesteps_since_restore": 28800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.4135168346031, "ram_util_percent": 74.3624477758663}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.17412895836566, "episode_reward_min": -156239.99242029167, "episode_reward_mean": -2476.737353737218, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7252.682082616794, "mean_processing_ms": 652.9924399951411, "mean_inference_ms": 2.124240719628313}, "off_policy_estimator": {}, "info": {"num_steps_trained": 29469, "num_steps_sampled": 30400, "sample_time_ms": 1785573.086, "load_time_ms": 12.478, "grad_time_ms": 704.327, "update_time_ms": 11.023, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 56649.921875, "policy_loss": -0.13213707506656647, "vf_loss": 56650.046875, "vf_explained_var": 0.10617084056138992, "kl": 0.034347306936979294, "entropy": 23.312946319580078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 30400, "episodes_total": 640, "training_iteration": 19, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_07-32-50", "timestamp": 1619393570, "time_this_iter_s": 1711.3288924694061, "time_total_s": 33853.92396569252, "pid": 2785620, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33853.92396569252, "timesteps_since_restore": 30400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 83.9811142974191, "ram_util_percent": 74.00450634985661}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.48043792462323, "episode_reward_min": -39572.2545638609, "episode_reward_mean": -8425.314538389302, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7359.984685087678, "mean_processing_ms": 539.1109011956115, "mean_inference_ms": 2.8146239952068424}, "off_policy_estimator": {}, "info": {"num_steps_trained": 31020, "num_steps_sampled": 32000, "sample_time_ms": 1698968.703, "load_time_ms": 295.85, "grad_time_ms": 1786.821, "update_time_ms": 3143.807, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 18583706.0, "policy_loss": -0.07470404356718063, "vf_loss": 18583706.0, "vf_explained_var": 0.003838479518890381, "kl": 0.028400929644703865, "entropy": 23.276182174682617, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 32000, "episodes_total": 672, "training_iteration": 20, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_08-14-16", "timestamp": 1619396056, "time_this_iter_s": 1704.398710012436, "time_total_s": 35558.322675704956, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1704.398710012436, "timesteps_since_restore": 1600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 81.10847039473684, "ram_util_percent": 52.159375}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.48043792462323, "episode_reward_min": -39572.2545638609, "episode_reward_mean": -4673.0604835650465, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7275.453634443545, "mean_processing_ms": 550.9668861736595, "mean_inference_ms": 2.6418176854692517}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32571, "num_steps_sampled": 33600, "sample_time_ms": 1636236.532, "load_time_ms": 153.722, "grad_time_ms": 1248.947, "update_time_ms": 1575.695, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 57245.484375, "policy_loss": -0.14099149405956268, "vf_loss": 57245.61328125, "vf_explained_var": 0.11452414840459824, "kl": 0.04001234471797943, "entropy": 23.19927978515625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 33600, "episodes_total": 704, "training_iteration": 21, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_08-40-31", "timestamp": 1619397631, "time_this_iter_s": 1574.2558798789978, "time_total_s": 37132.578555583954, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3278.6545898914337, "timesteps_since_restore": 3200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 85.23085485307213, "ram_util_percent": 55.894122885129114}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.7889758279759, "episode_reward_min": -39572.2545638609, "episode_reward_mean": -3411.5655997404815, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7211.065236535636, "mean_processing_ms": 562.8410350739476, "mean_inference_ms": 2.551302547593968}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34122, "num_steps_sampled": 35200, "sample_time_ms": 1615956.487, "load_time_ms": 105.264, "grad_time_ms": 1061.486, "update_time_ms": 1053.843, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 50515.74609375, "policy_loss": -0.12844814360141754, "vf_loss": 50515.8515625, "vf_explained_var": 0.12310938537120819, "kl": 0.032125361263751984, "entropy": 23.137187957763672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 35200, "episodes_total": 736, "training_iteration": 22, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_09-06-47", "timestamp": 1619399207, "time_this_iter_s": 1576.1177036762238, "time_total_s": 38708.69625926018, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4854.7722935676575, "timesteps_since_restore": 4800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 84.44795373665481, "ram_util_percent": 57.1894128113879}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5531662791761, "episode_reward_min": -1358.4346573014107, "episode_reward_mean": -870.8832125598169, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7086.133403685829, "mean_processing_ms": 595.6504271331414, "mean_inference_ms": 2.3797408543340652}, "off_policy_estimator": {}, "info": {"num_steps_trained": 35673, "num_steps_sampled": 36800, "sample_time_ms": 1611351.675, "load_time_ms": 81.119, "grad_time_ms": 970.388, "update_time_ms": 792.711, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 44553.55859375, "policy_loss": -0.12525779008865356, "vf_loss": 44553.671875, "vf_explained_var": 0.12276971340179443, "kl": 0.03181390091776848, "entropy": 23.066307067871094, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 36800, "episodes_total": 776, "training_iteration": 23, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_09-33-25", "timestamp": 1619400805, "time_this_iter_s": 1598.26917386055, "time_total_s": 40306.96543312073, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6453.041467428207, "timesteps_since_restore": 6400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 84.53317244405441, "ram_util_percent": 58.14510750329092}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5531662791761, "episode_reward_min": -1358.4346573014107, "episode_reward_mean": -810.2533116680498, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7059.170575984354, "mean_processing_ms": 620.800212824066, "mean_inference_ms": 2.3228216317279715}, "off_policy_estimator": {}, "info": {"num_steps_trained": 37224, "num_steps_sampled": 38400, "sample_time_ms": 1629916.578, "load_time_ms": 66.998, "grad_time_ms": 918.719, "update_time_ms": 637.705, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 50336.26171875, "policy_loss": -0.13864199817180634, "vf_loss": 50336.38671875, "vf_explained_var": 0.13587291538715363, "kl": 0.03883260861039162, "entropy": 23.036155700683594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 38400, "episodes_total": 808, "training_iteration": 24, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_10-01-50", "timestamp": 1619402510, "time_this_iter_s": 1704.9342050552368, "time_total_s": 42011.899638175964, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8157.975672483444, "timesteps_since_restore": 8000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 83.94971217105264, "ram_util_percent": 59.63301809210526}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5531662791761, "episode_reward_min": -1272.7420699940355, "episode_reward_mean": -830.0340725049942, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7067.284371772817, "mean_processing_ms": 634.0798846498625, "mean_inference_ms": 2.288461135364879}, "off_policy_estimator": {}, "info": {"num_steps_trained": 38775, "num_steps_sampled": 40000, "sample_time_ms": 1620281.806, "load_time_ms": 57.169, "grad_time_ms": 891.088, "update_time_ms": 533.35, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 55165.765625, "policy_loss": -0.1258101463317871, "vf_loss": 55165.87890625, "vf_explained_var": 0.12066993117332458, "kl": 0.03106514737010002, "entropy": 22.98737335205078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 40000, "episodes_total": 840, "training_iteration": 25, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_10-28-03", "timestamp": 1619404083, "time_this_iter_s": 1572.8994855880737, "time_total_s": 43584.79912376404, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9730.875158071518, "timesteps_since_restore": 9600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 86.21257244761479, "ram_util_percent": 60.90468123049488}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.2889769516002, "episode_reward_min": -1291.7162159989807, "episode_reward_mean": -848.3594792986406, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7084.24874878732, "mean_processing_ms": 633.8930838902619, "mean_inference_ms": 2.2609549087480776}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40326, "num_steps_sampled": 41600, "sample_time_ms": 1618031.227, "load_time_ms": 50.271, "grad_time_ms": 860.957, "update_time_ms": 459.599, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 54668.6875, "policy_loss": -0.1280396729707718, "vf_loss": 54668.80078125, "vf_explained_var": 0.12041280418634415, "kl": 0.030902845785021782, "entropy": 22.945995330810547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 41600, "episodes_total": 872, "training_iteration": 26, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_10-54-48", "timestamp": 1619405688, "time_this_iter_s": 1605.2511217594147, "time_total_s": 45190.05024552345, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11336.126279830933, "timesteps_since_restore": 11200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 85.23825327510916, "ram_util_percent": 61.83611353711791}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -394.0695229670349, "episode_reward_min": -4524.174933368187, "episode_reward_mean": -890.9679985559712, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7084.578237626376, "mean_processing_ms": 638.6829324749954, "mean_inference_ms": 2.2426978384930725}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41877, "num_steps_sampled": 43200, "sample_time_ms": 1631161.498, "load_time_ms": 45.483, "grad_time_ms": 839.648, "update_time_ms": 403.657, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 96711.4296875, "policy_loss": -0.09677700698375702, "vf_loss": 96711.4921875, "vf_explained_var": 0.09100326895713806, "kl": 0.026534700766205788, "entropy": 22.9091796875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 43200, "episodes_total": 912, "training_iteration": 27, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_11-23-32", "timestamp": 1619407412, "time_this_iter_s": 1723.8039391040802, "time_total_s": 46913.85418462753, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13059.930218935013, "timesteps_since_restore": 12800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 81.3073637103336, "ram_util_percent": 62.48242473555736}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.4047088015302, "episode_reward_min": -4524.174933368187, "episode_reward_mean": -877.7663369300061, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7103.211904718375, "mean_processing_ms": 641.7107362102715, "mean_inference_ms": 2.2332244109334347}, "off_policy_estimator": {}, "info": {"num_steps_trained": 43428, "num_steps_sampled": 44800, "sample_time_ms": 1639105.377, "load_time_ms": 41.584, "grad_time_ms": 825.854, "update_time_ms": 360.487, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 64906.7109375, "policy_loss": -0.13284093141555786, "vf_loss": 64906.8359375, "vf_explained_var": 0.12445833534002304, "kl": 0.03375760093331337, "entropy": 22.85110855102539, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 44800, "episodes_total": 944, "training_iteration": 28, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_11-51-56", "timestamp": 1619409116, "time_this_iter_s": 1703.4211044311523, "time_total_s": 48617.275289058685, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14763.351323366165, "timesteps_since_restore": 14400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 85.31654320987654, "ram_util_percent": 63.65810699588478}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.4047088015302, "episode_reward_min": -4524.174933368187, "episode_reward_mean": -906.8514506405191, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7127.547845570562, "mean_processing_ms": 643.5090988213539, "mean_inference_ms": 2.2256517468980657}, "off_policy_estimator": {}, "info": {"num_steps_trained": 44979, "num_steps_sampled": 46400, "sample_time_ms": 1639430.908, "load_time_ms": 38.386, "grad_time_ms": 814.591, "update_time_ms": 325.872, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 65197.421875, "policy_loss": -0.12804929912090302, "vf_loss": 65197.5390625, "vf_explained_var": 0.12252742797136307, "kl": 0.032226547598838806, "entropy": 22.755247116088867, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 46400, "episodes_total": 976, "training_iteration": 29, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_12-19-19", "timestamp": 1619410759, "time_this_iter_s": 1643.1158134937286, "time_total_s": 50260.391102552414, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16406.467136859894, "timesteps_since_restore": 16000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 86.02842509603073, "ram_util_percent": 64.60499359795135}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.4047088015302, "episode_reward_min": -1331.1780921775737, "episode_reward_mean": -931.0804799719491, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7158.591140086007, "mean_processing_ms": 640.6782753944293, "mean_inference_ms": 2.216960282024122}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46530, "num_steps_sampled": 48000, "sample_time_ms": 1636650.749, "load_time_ms": 9.78, "grad_time_ms": 706.317, "update_time_ms": 12.724, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 56312.99609375, "policy_loss": -0.13603733479976654, "vf_loss": 56313.12109375, "vf_explained_var": 0.13900865614414215, "kl": 0.03405370935797691, "entropy": 22.717607498168945, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 48000, "episodes_total": 1008, "training_iteration": 30, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_12-47-11", "timestamp": 1619412431, "time_this_iter_s": 1671.9084486961365, "time_total_s": 51932.29955124855, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18078.37558555603, "timesteps_since_restore": 17600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 85.85400419287211, "ram_util_percent": 65.83681341719078}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.2047664853822, "episode_reward_min": -1331.897189664424, "episode_reward_mean": -926.7222502635356, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7182.995306276439, "mean_processing_ms": 642.8520688659892, "mean_inference_ms": 2.2114241527079788}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48081, "num_steps_sampled": 49600, "sample_time_ms": 1649949.893, "load_time_ms": 9.774, "grad_time_ms": 702.988, "update_time_ms": 13.144, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 52695.984375, "policy_loss": -0.12445218116044998, "vf_loss": 52696.09765625, "vf_explained_var": 0.14193382859230042, "kl": 0.029977696016430855, "entropy": 22.682823181152344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 49600, "episodes_total": 1048, "training_iteration": 31, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_13-15-38", "timestamp": 1619414138, "time_this_iter_s": 1707.2139818668365, "time_total_s": 53639.51353311539, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19785.589567422867, "timesteps_since_restore": 19200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 84.39963039014373, "ram_util_percent": 66.49540041067762}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.2047664853822, "episode_reward_min": -6443.349020630472, "episode_reward_mean": -949.5319083551208, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7202.242651244502, "mean_processing_ms": 646.4001231561032, "mean_inference_ms": 2.206991989657268}, "off_policy_estimator": {}, "info": {"num_steps_trained": 49632, "num_steps_sampled": 51200, "sample_time_ms": 1662674.871, "load_time_ms": 9.942, "grad_time_ms": 708.094, "update_time_ms": 13.117, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 131923.0625, "policy_loss": -0.09641091525554657, "vf_loss": 131923.140625, "vf_explained_var": 0.11090190708637238, "kl": 0.026406602934002876, "entropy": 22.648332595825195, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 51200, "episodes_total": 1080, "training_iteration": 32, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_13-44-01", "timestamp": 1619415841, "time_this_iter_s": 1703.4189207553864, "time_total_s": 55342.93245387077, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21489.008488178253, "timesteps_since_restore": 20800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 85.49267188143268, "ram_util_percent": 67.4332235487855}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.2047664853822, "episode_reward_min": -6443.349020630472, "episode_reward_mean": -883.1988202522709, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7213.134385755638, "mean_processing_ms": 651.0859519604172, "mean_inference_ms": 2.20318383021}, "off_policy_estimator": {}, "info": {"num_steps_trained": 51183, "num_steps_sampled": 52800, "sample_time_ms": 1669182.453, "load_time_ms": 9.716, "grad_time_ms": 706.883, "update_time_ms": 13.056, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 40171.0078125, "policy_loss": -0.12486744672060013, "vf_loss": 40171.12109375, "vf_explained_var": 0.1623399704694748, "kl": 0.03279935196042061, "entropy": 22.54871940612793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 52800, "episodes_total": 1112, "training_iteration": 33, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_14-11-45", "timestamp": 1619417505, "time_this_iter_s": 1663.3298926353455, "time_total_s": 57006.26234650612, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23152.3383808136, "timesteps_since_restore": 22400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 83.77015177065766, "ram_util_percent": 68.74599494097808}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.1055067284242, "episode_reward_min": -6443.349020630472, "episode_reward_mean": -837.2680241249199, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7217.437380690968, "mean_processing_ms": 652.8069284798617, "mean_inference_ms": 2.1989873019667625}, "off_policy_estimator": {}, "info": {"num_steps_trained": 52734, "num_steps_sampled": 54400, "sample_time_ms": 1659890.033, "load_time_ms": 9.774, "grad_time_ms": 702.71, "update_time_ms": 12.659, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 44139.3359375, "policy_loss": -0.12112543731927872, "vf_loss": 44139.4453125, "vf_explained_var": 0.15574520826339722, "kl": 0.029362577944993973, "entropy": 22.494192123413086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 54400, "episodes_total": 1144, "training_iteration": 34, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_14-38-37", "timestamp": 1619419117, "time_this_iter_s": 1611.9606311321259, "time_total_s": 58618.222977638245, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24764.299011945724, "timesteps_since_restore": 24000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 84.68264462809917, "ram_util_percent": 69.75745976511527}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.1055067284242, "episode_reward_min": -1271.44179547205, "episode_reward_mean": -809.5436736557069, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7219.877252896307, "mean_processing_ms": 657.7061689811801, "mean_inference_ms": 2.198006586767899}, "off_policy_estimator": {}, "info": {"num_steps_trained": 54285, "num_steps_sampled": 56000, "sample_time_ms": 1678245.28, "load_time_ms": 10.006, "grad_time_ms": 704.311, "update_time_ms": 12.408, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 57720.2265625, "policy_loss": -0.13360626995563507, "vf_loss": 57720.34765625, "vf_explained_var": 0.15588818490505219, "kl": 0.0320318378508091, "entropy": 22.4653377532959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 56000, "episodes_total": 1184, "training_iteration": 35, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_15-07-53", "timestamp": 1619420873, "time_this_iter_s": 1756.4688742160797, "time_total_s": 60374.691851854324, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26520.767886161804, "timesteps_since_restore": 25600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 85.04393455706304, "ram_util_percent": 70.82350359138069}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.1055067284242, "episode_reward_min": -163870.75500346706, "episode_reward_mean": -2514.0712562369604, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7242.830172982101, "mean_processing_ms": 659.9267810569847, "mean_inference_ms": 2.19920138584909}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55836, "num_steps_sampled": 57600, "sample_time_ms": 1800644.082, "load_time_ms": 10.33, "grad_time_ms": 710.719, "update_time_ms": 11.721, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 104634232.0, "policy_loss": -0.05939352139830589, "vf_loss": 104634232.0, "vf_explained_var": 0.002207149052992463, "kl": 0.02061346359550953, "entropy": 22.456016540527344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 57600, "episodes_total": 1216, "training_iteration": 36, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_15-55-03", "timestamp": 1619423703, "time_this_iter_s": 2829.308974981308, "time_total_s": 63204.00082683563, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29350.076861143112, "timesteps_since_restore": 27200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.32416356877324, "ram_util_percent": 72.75315985130112}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.75364653928864, "episode_reward_min": -163870.75500346706, "episode_reward_mean": -2507.340841459092, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7265.308786477848, "mean_processing_ms": 661.9616850799238, "mean_inference_ms": 2.20028278558183}, "off_policy_estimator": {}, "info": {"num_steps_trained": 57387, "num_steps_sampled": 59200, "sample_time_ms": 1792061.484, "load_time_ms": 10.206, "grad_time_ms": 716.417, "update_time_ms": 11.898, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 44451.30859375, "policy_loss": -0.1203424260020256, "vf_loss": 44451.41796875, "vf_explained_var": 0.18362006545066833, "kl": 0.030791480094194412, "entropy": 22.36876678466797, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 59200, "episodes_total": 1248, "training_iteration": 37, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_16-22-21", "timestamp": 1619425341, "time_this_iter_s": 1638.0342900753021, "time_total_s": 64842.035116910934, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30988.111151218414, "timesteps_since_restore": 28800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 83.9892551369863, "ram_util_percent": 73.63047945205479}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.75364653928864, "episode_reward_min": -163870.75500346706, "episode_reward_mean": -2493.619354507142, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7280.572800513611, "mean_processing_ms": 661.2748090153415, "mean_inference_ms": 2.2005261858018046}, "off_policy_estimator": {}, "info": {"num_steps_trained": 58938, "num_steps_sampled": 60800, "sample_time_ms": 1786075.993, "load_time_ms": 10.22, "grad_time_ms": 726.386, "update_time_ms": 11.439, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 51167.7265625, "policy_loss": -0.12022523581981659, "vf_loss": 51167.83984375, "vf_explained_var": 0.1787910908460617, "kl": 0.03052963688969612, "entropy": 22.311262130737305, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 60800, "episodes_total": 1280, "training_iteration": 38, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_16-49-45", "timestamp": 1619426985, "time_this_iter_s": 1643.6561262607574, "time_total_s": 66485.69124317169, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32631.76727747917, "timesteps_since_restore": 30400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 85.3042662116041, "ram_util_percent": 74.1016638225256}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.84423551310226, "episode_reward_min": -1368.7310866710086, "episode_reward_mean": -807.1314003043894, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7284.75979373353, "mean_processing_ms": 664.3768891226814, "mean_inference_ms": 2.200886296400702}, "off_policy_estimator": {}, "info": {"num_steps_trained": 60489, "num_steps_sampled": 62400, "sample_time_ms": 1797921.801, "load_time_ms": 10.2, "grad_time_ms": 734.194, "update_time_ms": 10.843, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 39001.71484375, "policy_loss": -0.13309140503406525, "vf_loss": 39001.83984375, "vf_explained_var": 0.21410641074180603, "kl": 0.03606197237968445, "entropy": 22.265962600708008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 62400, "episodes_total": 1320, "training_iteration": 39, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_17-19-06", "timestamp": 1619428746, "time_this_iter_s": 1761.6478390693665, "time_total_s": 68247.33908224106, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34393.41511654854, "timesteps_since_restore": 32000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 84.38690286624205, "ram_util_percent": 74.93009554140129}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.84423551310226, "episode_reward_min": -1260.528123404515, "episode_reward_mean": -823.3482550839545, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7289.4931849797, "mean_processing_ms": 667.1776824843276, "mean_inference_ms": 2.1993068007356475}, "off_policy_estimator": {}, "info": {"num_steps_trained": 62040, "num_steps_sampled": 64000, "sample_time_ms": 1798436.435, "load_time_ms": 10.052, "grad_time_ms": 736.426, "update_time_ms": 10.811, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 49341.61328125, "policy_loss": -0.11876975744962692, "vf_loss": 49341.72265625, "vf_explained_var": 0.1788000911474228, "kl": 0.03207169100642204, "entropy": 22.17803192138672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 64000, "episodes_total": 1352, "training_iteration": 40, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_17-47-03", "timestamp": 1619430423, "time_this_iter_s": 1677.0732378959656, "time_total_s": 69924.41232013702, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36070.488354444504, "timesteps_since_restore": 33600, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 85.18616220735785, "ram_util_percent": 75.73975752508362}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.4715419040389, "episode_reward_min": -1290.7094710110675, "episode_reward_mean": -835.5376317634333, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7294.507537609546, "mean_processing_ms": 669.3759040480386, "mean_inference_ms": 2.1968135672976477}, "off_policy_estimator": {}, "info": {"num_steps_trained": 63591, "num_steps_sampled": 65600, "sample_time_ms": 1793341.511, "load_time_ms": 9.655, "grad_time_ms": 743.973, "update_time_ms": 10.612, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 56396.51171875, "policy_loss": -0.1259785294532776, "vf_loss": 56396.625, "vf_explained_var": 0.1783675253391266, "kl": 0.03159867972135544, "entropy": 22.10222625732422, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 65600, "episodes_total": 1384, "training_iteration": 41, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_18-14-40", "timestamp": 1619432080, "time_this_iter_s": 1656.3333315849304, "time_total_s": 71580.74565172195, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37726.821686029434, "timesteps_since_restore": 35200, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 86.07613203554803, "ram_util_percent": 76.81735082522218}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.4715419040389, "episode_reward_min": -1290.7094710110675, "episode_reward_mean": -862.6808964149047, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7305.304247745698, "mean_processing_ms": 668.1358811495728, "mean_inference_ms": 2.193988539497362}, "off_policy_estimator": {}, "info": {"num_steps_trained": 65142, "num_steps_sampled": 67200, "sample_time_ms": 1786311.715, "load_time_ms": 10.109, "grad_time_ms": 736.363, "update_time_ms": 10.477, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 46592.49609375, "policy_loss": -0.12160176783800125, "vf_loss": 46592.609375, "vf_explained_var": 0.18477939069271088, "kl": 0.030701952055096626, "entropy": 22.031923294067383, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 67200, "episodes_total": 1416, "training_iteration": 42, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_18-41-53", "timestamp": 1619433713, "time_this_iter_s": 1633.049409866333, "time_total_s": 73213.79506158829, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39359.87109589577, "timesteps_since_restore": 36800, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 86.24873336195793, "ram_util_percent": 77.6772005152426}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.4023388361881, "episode_reward_min": -1290.7094710110675, "episode_reward_mean": -857.9669578184906, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7306.339269779954, "mean_processing_ms": 670.1536313830552, "mean_inference_ms": 2.1912749629803163}, "off_policy_estimator": {}, "info": {"num_steps_trained": 66693, "num_steps_sampled": 68800, "sample_time_ms": 1801388.713, "load_time_ms": 10.638, "grad_time_ms": 743.079, "update_time_ms": 10.888, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 56196.7265625, "policy_loss": -0.13100245594978333, "vf_loss": 56196.84765625, "vf_explained_var": 0.19343966245651245, "kl": 0.033314451575279236, "entropy": 22.00413703918457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 68800, "episodes_total": 1456, "training_iteration": 43, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_19-12-07", "timestamp": 1619435527, "time_this_iter_s": 1814.17782497406, "time_total_s": 75027.97288656235, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41174.04892086983, "timesteps_since_restore": 38400, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 85.22922303826826, "ram_util_percent": 78.4275222265172}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.4023388361881, "episode_reward_min": -1268.3231250727965, "episode_reward_mean": -848.4302590697912, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7318.040917186494, "mean_processing_ms": 672.4832497054739, "mean_inference_ms": 2.190260920916398}, "off_policy_estimator": {}, "info": {"num_steps_trained": 68244, "num_steps_sampled": 70400, "sample_time_ms": 1814955.793, "load_time_ms": 10.636, "grad_time_ms": 749.158, "update_time_ms": 10.694, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 44779.546875, "policy_loss": -0.1285519301891327, "vf_loss": 44779.66796875, "vf_explained_var": 0.1989680379629135, "kl": 0.03099791519343853, "entropy": 21.93280601501465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 70400, "episodes_total": 1488, "training_iteration": 44, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_19-41-15", "timestamp": 1619437275, "time_this_iter_s": 1747.6909348964691, "time_total_s": 76775.66382145882, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42921.7398557663, "timesteps_since_restore": 40000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 84.64793421580424, "ram_util_percent": 79.51460088247093}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.62103561456894, "episode_reward_min": -1271.108925536344, "episode_reward_mean": -830.6443312079582, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7331.495915534385, "mean_processing_ms": 674.8747297622675, "mean_inference_ms": 2.189796935107289}, "off_policy_estimator": {}, "info": {"num_steps_trained": 69795, "num_steps_sampled": 72000, "sample_time_ms": 1808595.864, "load_time_ms": 10.464, "grad_time_ms": 744.589, "update_time_ms": 10.98, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 40331.9921875, "policy_loss": -0.12020039558410645, "vf_loss": 40332.1015625, "vf_explained_var": 0.21173952519893646, "kl": 0.03164243698120117, "entropy": 21.847684860229492, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 72000, "episodes_total": 1520, "training_iteration": 45, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_20-09-28", "timestamp": 1619438968, "time_this_iter_s": 1692.8241856098175, "time_total_s": 78468.48800706863, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44614.564041376114, "timesteps_since_restore": 41600, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 86.40327257663628, "ram_util_percent": 80.03753106876553}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.62103561456894, "episode_reward_min": -1271.108925536344, "episode_reward_mean": -828.7048461039969, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7346.394782397517, "mean_processing_ms": 675.0662771963302, "mean_inference_ms": 2.1892928968754757}, "off_policy_estimator": {}, "info": {"num_steps_trained": 71346, "num_steps_sampled": 73600, "sample_time_ms": 1692096.449, "load_time_ms": 9.961, "grad_time_ms": 740.192, "update_time_ms": 11.135, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 46892.67578125, "policy_loss": -0.12020616978406906, "vf_loss": 46892.78515625, "vf_explained_var": 0.18979991972446442, "kl": 0.029921384528279305, "entropy": 21.760332107543945, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 73600, "episodes_total": 1552, "training_iteration": 46, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_20-37-12", "timestamp": 1619440632, "time_this_iter_s": 1664.2590637207031, "time_total_s": 80132.74707078934, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46278.82310509682, "timesteps_since_restore": 43200, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 85.18062342038753, "ram_util_percent": 80.1326453243471}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.62103561456894, "episode_reward_min": -1271.108925536344, "episode_reward_mean": -831.0451064353595, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7351.505537544291, "mean_processing_ms": 678.9257092390371, "mean_inference_ms": 2.1878374992663656}, "off_policy_estimator": {}, "info": {"num_steps_trained": 72897, "num_steps_sampled": 75200, "sample_time_ms": 1714563.107, "load_time_ms": 9.688, "grad_time_ms": 737.015, "update_time_ms": 10.938, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 49929.16015625, "policy_loss": -0.13968735933303833, "vf_loss": 49929.28515625, "vf_explained_var": 0.2094525694847107, "kl": 0.03424578532576561, "entropy": 21.735462188720703, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 75200, "episodes_total": 1592, "training_iteration": 47, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_21-08-15", "timestamp": 1619442495, "time_this_iter_s": 1862.6695539951324, "time_total_s": 81995.41662478447, "pid": 2958795, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48141.49265909195, "timesteps_since_restore": 44800, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 84.16125753012048, "ram_util_percent": 80.89450301204819}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.78129880716006, "episode_reward_min": -32615.403896419746, "episode_reward_mean": -6792.174817819561, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7439.366099401494, "mean_processing_ms": 566.4707543838083, "mean_inference_ms": 2.8110638779787287}, "off_policy_estimator": {}, "info": {"num_steps_trained": 74448, "num_steps_sampled": 76800, "sample_time_ms": 1714617.01, "load_time_ms": 338.118, "grad_time_ms": 1775.342, "update_time_ms": 3259.731, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 11071823.0, "policy_loss": -0.07558834552764893, "vf_loss": 11071823.0, "vf_explained_var": 0.009819372557103634, "kl": 0.0294883381575346, "entropy": 21.68885612487793, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 76800, "episodes_total": 1624, "training_iteration": 48, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_22-05-02", "timestamp": 1619445902, "time_this_iter_s": 1720.1899108886719, "time_total_s": 83715.60653567314, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1720.1899108886719, "timesteps_since_restore": 1600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 80.58187372708758, "ram_util_percent": 52.48464358452138}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.78129880716006, "episode_reward_min": -32615.403896419746, "episode_reward_mean": -3825.564758428757, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7269.871063664017, "mean_processing_ms": 587.3946581172245, "mean_inference_ms": 2.642685500027336}, "off_policy_estimator": {}, "info": {"num_steps_trained": 75999, "num_steps_sampled": 78400, "sample_time_ms": 1627332.66, "load_time_ms": 176.219, "grad_time_ms": 1264.989, "update_time_ms": 1640.231, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 38055.234375, "policy_loss": -0.12972278892993927, "vf_loss": 38055.359375, "vf_explained_var": 0.22696594893932343, "kl": 0.040441516786813736, "entropy": 21.540000915527344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 78400, "episodes_total": 1656, "training_iteration": 49, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_22-30-42", "timestamp": 1619447442, "time_this_iter_s": 1540.8637413978577, "time_total_s": 85256.470277071, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3261.0536522865295, "timesteps_since_restore": 3200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 84.46464968152866, "ram_util_percent": 56.69790718835305}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.4393638261545, "episode_reward_min": -32615.403896419746, "episode_reward_mean": -2829.712223671521, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7186.675999255943, "mean_processing_ms": 594.1071028283468, "mean_inference_ms": 2.548214148752437}, "off_policy_estimator": {}, "info": {"num_steps_trained": 77550, "num_steps_sampled": 80000, "sample_time_ms": 1603352.294, "load_time_ms": 122.275, "grad_time_ms": 1073.74, "update_time_ms": 1097.928, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 44698.19921875, "policy_loss": -0.12192463129758835, "vf_loss": 44698.30859375, "vf_explained_var": 0.21243523061275482, "kl": 0.03124520368874073, "entropy": 21.447532653808594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 80000, "episodes_total": 1688, "training_iteration": 50, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_22-56-39", "timestamp": 1619448999, "time_this_iter_s": 1556.129520893097, "time_total_s": 86812.5997979641, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4817.1831731796265, "timesteps_since_restore": 4800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 84.5767012167643, "ram_util_percent": 58.06570527264534}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5606024331041, "episode_reward_min": -1326.8739715749045, "episode_reward_mean": -874.3730937738634, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7060.896033561921, "mean_processing_ms": 619.2312413436779, "mean_inference_ms": 2.3731496375874483}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79101, "num_steps_sampled": 81600, "sample_time_ms": 1620014.715, "load_time_ms": 95.16, "grad_time_ms": 967.731, "update_time_ms": 826.944, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 50938.52734375, "policy_loss": -0.13351589441299438, "vf_loss": 50938.65234375, "vf_explained_var": 0.2100260704755783, "kl": 0.03273623064160347, "entropy": 21.380321502685547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 81600, "episodes_total": 1728, "training_iteration": 51, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_23-24-29", "timestamp": 1619450669, "time_this_iter_s": 1670.695728302002, "time_total_s": 88483.2955262661, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6487.878901481628, "timesteps_since_restore": 6400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 83.95791019723039, "ram_util_percent": 59.1300041963911}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5606024331041, "episode_reward_min": -1333.5484753554376, "episode_reward_mean": -856.68838042174, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7068.505923795347, "mean_processing_ms": 631.4960345702733, "mean_inference_ms": 2.3085040545384876}, "off_policy_estimator": {}, "info": {"num_steps_trained": 80652, "num_steps_sampled": 83200, "sample_time_ms": 1635449.061, "load_time_ms": 78.879, "grad_time_ms": 908.853, "update_time_ms": 663.484, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 47392.6015625, "policy_loss": -0.1290150284767151, "vf_loss": 47392.71875, "vf_explained_var": 0.21805158257484436, "kl": 0.03441150113940239, "entropy": 21.334665298461914, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 83200, "episodes_total": 1760, "training_iteration": 52, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-26_23-52-47", "timestamp": 1619452367, "time_this_iter_s": 1697.9001860618591, "time_total_s": 90181.19571232796, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8185.779087543488, "timesteps_since_restore": 8000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 82.93828996282527, "ram_util_percent": 60.33795952085915}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5606024331041, "episode_reward_min": -1333.5484753554376, "episode_reward_mean": -818.3398456437043, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7092.372189676997, "mean_processing_ms": 641.0541108428993, "mean_inference_ms": 2.271188913128804}, "off_policy_estimator": {}, "info": {"num_steps_trained": 82203, "num_steps_sampled": 84800, "sample_time_ms": 1626247.842, "load_time_ms": 67.834, "grad_time_ms": 878.927, "update_time_ms": 554.571, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 42424.890625, "policy_loss": -0.12202448397874832, "vf_loss": 42424.99609375, "vf_explained_var": 0.2258843332529068, "kl": 0.03039579465985298, "entropy": 21.19977569580078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 84800, "episodes_total": 1792, "training_iteration": 53, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_00-19-08", "timestamp": 1619453948, "time_this_iter_s": 1581.010409116745, "time_total_s": 91762.2061214447, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9766.789496660233, "timesteps_since_restore": 9600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 85.10425720620842, "ram_util_percent": 61.527184035476715}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.21023169765726, "episode_reward_min": -1333.5484753554376, "episode_reward_mean": -796.8904035111386, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7093.753674258832, "mean_processing_ms": 638.3223660977709, "mean_inference_ms": 2.2425527400045913}, "off_policy_estimator": {}, "info": {"num_steps_trained": 83754, "num_steps_sampled": 86400, "sample_time_ms": 1617655.37, "load_time_ms": 59.837, "grad_time_ms": 852.396, "update_time_ms": 476.938, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 31689.0546875, "policy_loss": -0.11421846598386765, "vf_loss": 31689.158203125, "vf_explained_var": 0.2443944811820984, "kl": 0.029107432812452316, "entropy": 21.121137619018555, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 86400, "episodes_total": 1824, "training_iteration": 54, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_00-45-15", "timestamp": 1619455515, "time_this_iter_s": 1566.8357582092285, "time_total_s": 93329.04187965393, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11333.625254869461, "timesteps_since_restore": 11200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 83.43619686800895, "ram_util_percent": 62.405413870246086}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.21023169765726, "episode_reward_min": -1266.6068984322233, "episode_reward_mean": -786.5590342942291, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7072.738101409327, "mean_processing_ms": 652.4970698733831, "mean_inference_ms": 2.2223074026333656}, "off_policy_estimator": {}, "info": {"num_steps_trained": 85305, "num_steps_sampled": 88000, "sample_time_ms": 1624721.351, "load_time_ms": 54.105, "grad_time_ms": 835.943, "update_time_ms": 418.752, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 43772.8671875, "policy_loss": -0.12521587312221527, "vf_loss": 43772.984375, "vf_explained_var": 0.23197735846042633, "kl": 0.033233724534511566, "entropy": 21.098064422607422, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 88000, "episodes_total": 1864, "training_iteration": 55, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_01-13-10", "timestamp": 1619457190, "time_this_iter_s": 1674.947768688202, "time_total_s": 95003.98964834213, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13008.573023557663, "timesteps_since_restore": 12800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 84.24524905818333, "ram_util_percent": 63.18832147341984}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.21934702524993, "episode_reward_min": -1371.7417128395427, "episode_reward_mean": -814.5327866233902, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7087.394708550251, "mean_processing_ms": 658.8146292287779, "mean_inference_ms": 2.2084688764774314}, "off_policy_estimator": {}, "info": {"num_steps_trained": 86856, "num_steps_sampled": 89600, "sample_time_ms": 1635779.478, "load_time_ms": 50.117, "grad_time_ms": 823.627, "update_time_ms": 373.357, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 281688.65625, "policy_loss": -0.07145153731107712, "vf_loss": 281688.71875, "vf_explained_var": 0.14661599695682526, "kl": 0.024884473532438278, "entropy": 21.117412567138672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 89600, "episodes_total": 1896, "training_iteration": 56, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_01-41-55", "timestamp": 1619458915, "time_this_iter_s": 1725.018713235855, "time_total_s": 96729.00836157799, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14733.591736793518, "timesteps_since_restore": 14400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 84.98101626016259, "ram_util_percent": 64.03995934959349}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5010055198498, "episode_reward_min": -12307.276603197683, "episode_reward_mean": -940.3169503596423, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7114.095082579467, "mean_processing_ms": 663.2109210974766, "mean_inference_ms": 2.1981931938266426}, "off_policy_estimator": {}, "info": {"num_steps_trained": 88407, "num_steps_sampled": 91200, "sample_time_ms": 1633941.191, "load_time_ms": 46.387, "grad_time_ms": 810.478, "update_time_ms": 337.161, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 81243.09375, "policy_loss": -0.11597280204296112, "vf_loss": 81243.1953125, "vf_explained_var": 0.18137282133102417, "kl": 0.03070736676454544, "entropy": 21.014902114868164, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 91200, "episodes_total": 1928, "training_iteration": 57, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_02-08-54", "timestamp": 1619460534, "time_this_iter_s": 1618.1363813877106, "time_total_s": 98347.1447429657, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16351.728118181229, "timesteps_since_restore": 16000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.50970537261699, "ram_util_percent": 65.33006932409012}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.5010055198498, "episode_reward_min": -12307.276603197683, "episode_reward_mean": -963.6463990889571, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7132.770598829562, "mean_processing_ms": 659.3079221260417, "mean_inference_ms": 2.1882799065279572}, "off_policy_estimator": {}, "info": {"num_steps_trained": 89958, "num_steps_sampled": 92800, "sample_time_ms": 1624851.662, "load_time_ms": 13.775, "grad_time_ms": 706.865, "update_time_ms": 12.292, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 45560.75, "policy_loss": -0.12083650380373001, "vf_loss": 45560.8671875, "vf_explained_var": 0.2334347665309906, "kl": 0.028950918465852737, "entropy": 20.91313362121582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 92800, "episodes_total": 1960, "training_iteration": 58, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_02-35-58", "timestamp": 1619462158, "time_this_iter_s": 1624.4995920658112, "time_total_s": 99971.64433503151, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17976.22771024704, "timesteps_since_restore": 17600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 85.13349158394475, "ram_util_percent": 66.14833836858007}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.0304498873425, "episode_reward_min": -12307.276603197683, "episode_reward_mean": -939.2280434770529, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7132.8724254489525, "mean_processing_ms": 664.6261292963552, "mean_inference_ms": 2.181509870872407}, "off_policy_estimator": {}, "info": {"num_steps_trained": 91509, "num_steps_sampled": 94400, "sample_time_ms": 1634602.427, "load_time_ms": 13.52, "grad_time_ms": 697.634, "update_time_ms": 11.326, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 41611.234375, "policy_loss": -0.10985026508569717, "vf_loss": 41611.33203125, "vf_explained_var": 0.24354618787765503, "kl": 0.027907103300094604, "entropy": 20.803224563598633, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 94400, "episodes_total": 2000, "training_iteration": 59, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_03-03-16", "timestamp": 1619463796, "time_this_iter_s": 1638.2653896808624, "time_total_s": 101609.90972471237, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19614.493099927902, "timesteps_since_restore": 19200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 84.35755241762944, "ram_util_percent": 66.93970902866924}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.41418681839326, "episode_reward_min": -1241.6035085259439, "episode_reward_mean": -793.0433580454185, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7136.724749181152, "mean_processing_ms": 667.2107604407347, "mean_inference_ms": 2.1745606265162127}, "off_policy_estimator": {}, "info": {"num_steps_trained": 93060, "num_steps_sampled": 96000, "sample_time_ms": 1647274.381, "load_time_ms": 13.273, "grad_time_ms": 696.353, "update_time_ms": 11.207, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 34542.98046875, "policy_loss": -0.1280803233385086, "vf_loss": 34543.09765625, "vf_explained_var": 0.26053112745285034, "kl": 0.030963905155658722, "entropy": 20.7913875579834, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 96000, "episodes_total": 2032, "training_iteration": 60, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_03-31-19", "timestamp": 1619465479, "time_this_iter_s": 1682.83039021492, "time_total_s": 103292.74011492729, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21297.323490142822, "timesteps_since_restore": 20800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 84.30154166666667, "ram_util_percent": 67.80479166666667}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.41418681839326, "episode_reward_min": -1241.6035085259439, "episode_reward_mean": -762.705457325772, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7138.0861845621375, "mean_processing_ms": 670.9978685868663, "mean_inference_ms": 2.169051346555158}, "off_policy_estimator": {}, "info": {"num_steps_trained": 94611, "num_steps_sampled": 97600, "sample_time_ms": 1646503.171, "load_time_ms": 13.322, "grad_time_ms": 702.727, "update_time_ms": 10.767, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 38376.83203125, "policy_loss": -0.12222396582365036, "vf_loss": 38376.94140625, "vf_explained_var": 0.2629449963569641, "kl": 0.02947458066046238, "entropy": 20.714908599853516, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 97600, "episodes_total": 2064, "training_iteration": 61, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_03-59-02", "timestamp": 1619467142, "time_this_iter_s": 1663.050185918808, "time_total_s": 104955.7903008461, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22960.37367606163, "timesteps_since_restore": 22400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 83.27681281618888, "ram_util_percent": 68.85518549747049}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.41418681839326, "episode_reward_min": -4656.237874727681, "episode_reward_mean": -811.6583510581602, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7138.842605655438, "mean_processing_ms": 671.0639514392975, "mean_inference_ms": 2.164152874777402}, "off_policy_estimator": {}, "info": {"num_steps_trained": 96162, "num_steps_sampled": 99200, "sample_time_ms": 1642608.643, "load_time_ms": 13.32, "grad_time_ms": 709.114, "update_time_ms": 11.167, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 87200.75, "policy_loss": -0.10192951560020447, "vf_loss": 87200.84375, "vf_explained_var": 0.1956995129585266, "kl": 0.025097142904996872, "entropy": 20.658498764038086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 99200, "episodes_total": 2096, "training_iteration": 62, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_04-26-41", "timestamp": 1619468801, "time_this_iter_s": 1659.0255970954895, "time_total_s": 106614.81589794159, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24619.39927315712, "timesteps_since_restore": 24000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 84.57776838546069, "ram_util_percent": 69.7605663567202}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.1128045727829, "episode_reward_min": -4656.237874727681, "episode_reward_mean": -857.330238555944, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7155.913210679694, "mean_processing_ms": 676.2055855319222, "mean_inference_ms": 2.1627760726068774}, "off_policy_estimator": {}, "info": {"num_steps_trained": 97713, "num_steps_sampled": 100800, "sample_time_ms": 1658514.6, "load_time_ms": 13.486, "grad_time_ms": 706.117, "update_time_ms": 11.043, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 43926.77734375, "policy_loss": -0.12359368801116943, "vf_loss": 43926.8828125, "vf_explained_var": 0.2568764090538025, "kl": 0.030732620507478714, "entropy": 20.630672454833984, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 100800, "episodes_total": 2136, "training_iteration": 63, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_04-55-42", "timestamp": 1619470542, "time_this_iter_s": 1740.0448217391968, "time_total_s": 108354.86071968079, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26359.444094896317, "timesteps_since_restore": 25600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 84.87106005642885, "ram_util_percent": 70.6006449012495}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.3096093752687, "episode_reward_min": -4656.237874727681, "episode_reward_mean": -882.7992627127823, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7173.331574908509, "mean_processing_ms": 678.8126442962216, "mean_inference_ms": 2.161658834937484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 99264, "num_steps_sampled": 102400, "sample_time_ms": 1672660.543, "load_time_ms": 13.562, "grad_time_ms": 703.901, "update_time_ms": 11.618, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 39188.875, "policy_loss": -0.13368801772594452, "vf_loss": 39188.99609375, "vf_explained_var": 0.2727949023246765, "kl": 0.034205127507448196, "entropy": 20.575420379638672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 102400, "episodes_total": 2168, "training_iteration": 64, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_05-24-10", "timestamp": 1619472250, "time_this_iter_s": 1708.2755937576294, "time_total_s": 110063.13631343842, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28067.719688653946, "timesteps_since_restore": 27200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 85.34805088223226, "ram_util_percent": 71.36922445629872}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.8115806390653, "episode_reward_min": -1310.2609650825661, "episode_reward_mean": -842.6753473223694, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7191.443251700021, "mean_processing_ms": 680.9279355657226, "mean_inference_ms": 2.160712179394419}, "off_policy_estimator": {}, "info": {"num_steps_trained": 100815, "num_steps_sampled": 104000, "sample_time_ms": 1673103.66, "load_time_ms": 13.823, "grad_time_ms": 702.383, "update_time_ms": 11.517, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 43816.37109375, "policy_loss": -0.12241685390472412, "vf_loss": 43816.484375, "vf_explained_var": 0.2607170343399048, "kl": 0.027938472107052803, "entropy": 20.445032119750977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 104000, "episodes_total": 2200, "training_iteration": 65, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_05-52-09", "timestamp": 1619473929, "time_this_iter_s": 1679.3670563697815, "time_total_s": 111742.5033698082, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29747.086745023727, "timesteps_since_restore": 28800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 84.2679331941545, "ram_util_percent": 72.44246346555325}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.8115806390653, "episode_reward_min": -150034.2411139527, "episode_reward_mean": -2341.4970289599523, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7210.045947448327, "mean_processing_ms": 679.1361292032004, "mean_inference_ms": 2.1591400997659655}, "off_policy_estimator": {}, "info": {"num_steps_trained": 102366, "num_steps_sampled": 105600, "sample_time_ms": 1819770.744, "load_time_ms": 13.711, "grad_time_ms": 700.452, "update_time_ms": 11.536, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 101277440.0, "policy_loss": -0.059443626552820206, "vf_loss": 101277440.0, "vf_explained_var": 0.0034244765993207693, "kl": 0.01987208053469658, "entropy": 20.406850814819336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 105600, "episodes_total": 2232, "training_iteration": 66, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_06-45-21", "timestamp": 1619477121, "time_this_iter_s": 3191.6684243679047, "time_total_s": 114934.1717941761, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32938.75516939163, "timesteps_since_restore": 30400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 51.740487697715295, "ram_util_percent": 75.15155975395432}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.8115806390653, "episode_reward_min": -150034.2411139527, "episode_reward_mean": -2288.900376056145, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7243.988607793274, "mean_processing_ms": 683.6103653808925, "mean_inference_ms": 2.159011844545506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 103917, "num_steps_sampled": 107200, "sample_time_ms": 1830654.467, "load_time_ms": 14.336, "grad_time_ms": 712.481, "update_time_ms": 11.384, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 69988.9921875, "policy_loss": -0.10115034878253937, "vf_loss": 69989.0625, "vf_explained_var": 0.2344638705253601, "kl": 0.02743394300341606, "entropy": 20.338253021240234, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 107200, "episodes_total": 2272, "training_iteration": 67, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_07-14-08", "timestamp": 1619478848, "time_this_iter_s": 1727.0947511196136, "time_total_s": 116661.26654529572, "pid": 3215473, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34665.849920511246, "timesteps_since_restore": 32000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 85.80816077953715, "ram_util_percent": 74.29784815265936}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.48097919512645, "episode_reward_min": -42760.95517817432, "episode_reward_mean": -7722.385215263031, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7233.939426603602, "mean_processing_ms": 578.1508457304826, "mean_inference_ms": 2.751069430688127}, "off_policy_estimator": {}, "info": {"num_steps_trained": 105468, "num_steps_sampled": 108800, "sample_time_ms": 1707857.181, "load_time_ms": 278.727, "grad_time_ms": 1667.351, "update_time_ms": 2991.819, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 16608340.0, "policy_loss": -0.06420686095952988, "vf_loss": 16608340.0, "vf_explained_var": 0.011115881614387035, "kl": 0.02689223363995552, "entropy": 20.325117111206055, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 108800, "episodes_total": 2304, "training_iteration": 68, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_08-29-00", "timestamp": 1619483340, "time_this_iter_s": 1713.040093421936, "time_total_s": 118374.30663871765, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1713.040093421936, "timesteps_since_restore": 1600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 78.98040899795501, "ram_util_percent": 53.45558282208589}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.48097919512645, "episode_reward_min": -42760.95517817432, "episode_reward_mean": -4277.6926277267185, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7103.524412390074, "mean_processing_ms": 590.3198001376261, "mean_inference_ms": 2.588986065763068}, "off_policy_estimator": {}, "info": {"num_steps_trained": 107019, "num_steps_sampled": 110400, "sample_time_ms": 1602897.041, "load_time_ms": 145.813, "grad_time_ms": 1200.16, "update_time_ms": 1503.627, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 38543.46484375, "policy_loss": -0.12818817794322968, "vf_loss": 38543.58203125, "vf_explained_var": 0.2971872091293335, "kl": 0.039242684841156006, "entropy": 20.148269653320312, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 110400, "episodes_total": 2336, "training_iteration": 69, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_08-53-59", "timestamp": 1619484839, "time_this_iter_s": 1498.714237689972, "time_total_s": 119873.02087640762, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3211.754331111908, "timesteps_since_restore": 3200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 85.76944314459521, "ram_util_percent": 58.20332241459991}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.5104925114135, "episode_reward_min": -42760.95517817432, "episode_reward_mean": -3116.534694801838, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7012.326450557012, "mean_processing_ms": 593.7199027048672, "mean_inference_ms": 2.5061523356456603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 108570, "num_steps_sampled": 112000, "sample_time_ms": 1570980.981, "load_time_ms": 103.106, "grad_time_ms": 1033.509, "update_time_ms": 1006.212, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 37982.44140625, "policy_loss": -0.11697990447282791, "vf_loss": 37982.5546875, "vf_explained_var": 0.29168441891670227, "kl": 0.03862394392490387, "entropy": 19.96943473815918, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 112000, "episodes_total": 2368, "training_iteration": 70, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_09-19-07", "timestamp": 1619486347, "time_this_iter_s": 1507.8966958522797, "time_total_s": 121380.9175722599, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4719.651026964188, "timesteps_since_restore": 4800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 83.53296141329614, "ram_util_percent": 59.378428637842866}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.5104925114135, "episode_reward_min": -1305.997180096156, "episode_reward_mean": -851.694728210085, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6877.667969532203, "mean_processing_ms": 612.1286582943178, "mean_inference_ms": 2.346102863285174}, "off_policy_estimator": {}, "info": {"num_steps_trained": 110121, "num_steps_sampled": 113600, "sample_time_ms": 1580435.814, "load_time_ms": 80.228, "grad_time_ms": 954.695, "update_time_ms": 757.509, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 47783.578125, "policy_loss": -0.12527284026145935, "vf_loss": 47783.69140625, "vf_explained_var": 0.2817848324775696, "kl": 0.036272112280130386, "entropy": 19.894197463989258, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 113600, "episodes_total": 2408, "training_iteration": 71, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_09-45-57", "timestamp": 1619487957, "time_this_iter_s": 1609.5619826316833, "time_total_s": 122990.47955489159, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6329.213009595871, "timesteps_since_restore": 6400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 84.5515243902439, "ram_util_percent": 60.48153310104529}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -386.90633861718305, "episode_reward_min": -1305.997180096156, "episode_reward_mean": -821.2402759835948, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6881.339188128927, "mean_processing_ms": 622.4716690010492, "mean_inference_ms": 2.290576555366973}, "off_policy_estimator": {}, "info": {"num_steps_trained": 111672, "num_steps_sampled": 115200, "sample_time_ms": 1588798.073, "load_time_ms": 65.988, "grad_time_ms": 898.131, "update_time_ms": 607.887, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 38012.578125, "policy_loss": -0.12706629931926727, "vf_loss": 38012.69140625, "vf_explained_var": 0.3111976385116577, "kl": 0.04111994057893753, "entropy": 19.923545837402344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 115200, "episodes_total": 2440, "training_iteration": 72, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_10-13-00", "timestamp": 1619489580, "time_this_iter_s": 1622.9535241127014, "time_total_s": 124613.43307900429, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7952.166533708572, "timesteps_since_restore": 8000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 85.39775280898877, "ram_util_percent": 61.529904926534144}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -386.90633861718305, "episode_reward_min": -1340.7598788799376, "episode_reward_mean": -865.5082616210743, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6911.71858609837, "mean_processing_ms": 632.7875048266528, "mean_inference_ms": 2.2540316362161126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113223, "num_steps_sampled": 116800, "sample_time_ms": 1585852.178, "load_time_ms": 57.437, "grad_time_ms": 859.238, "update_time_ms": 507.967, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 47417.37890625, "policy_loss": -0.1168055459856987, "vf_loss": 47417.484375, "vf_explained_var": 0.28034499287605286, "kl": 0.02825872227549553, "entropy": 19.73834228515625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 116800, "episodes_total": 2472, "training_iteration": 73, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_10-39-12", "timestamp": 1619491152, "time_this_iter_s": 1571.828017950058, "time_total_s": 126185.26109695435, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9523.99455165863, "timesteps_since_restore": 9600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 84.45820695807315, "ram_util_percent": 62.556779661016954}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -386.90633861718305, "episode_reward_min": -1340.7598788799376, "episode_reward_mean": -820.9667664962419, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6921.827714601915, "mean_processing_ms": 637.8198642438961, "mean_inference_ms": 2.2275995877392387}, "off_policy_estimator": {}, "info": {"num_steps_trained": 114774, "num_steps_sampled": 118400, "sample_time_ms": 1582772.599, "load_time_ms": 50.964, "grad_time_ms": 839.411, "update_time_ms": 437.367, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 42563.21484375, "policy_loss": -0.12250220775604248, "vf_loss": 42563.328125, "vf_explained_var": 0.28899040818214417, "kl": 0.028929578140378, "entropy": 19.65174102783203, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 118400, "episodes_total": 2504, "training_iteration": 74, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_11-05-17", "timestamp": 1619492717, "time_this_iter_s": 1565.0603756904602, "time_total_s": 127750.3214726448, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11089.05492734909, "timesteps_since_restore": 11200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.37025089605736, "ram_util_percent": 63.457930107526884}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.637765374294, "episode_reward_min": -1452.469048523305, "episode_reward_mean": -866.3365021718072, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6926.427286627112, "mean_processing_ms": 639.0350331993172, "mean_inference_ms": 2.2087465221935423}, "off_policy_estimator": {}, "info": {"num_steps_trained": 116325, "num_steps_sampled": 120000, "sample_time_ms": 1590858.941, "load_time_ms": 45.996, "grad_time_ms": 820.243, "update_time_ms": 384.565, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 39958.5234375, "policy_loss": -0.1188274696469307, "vf_loss": 39958.62890625, "vf_explained_var": 0.3005543649196625, "kl": 0.032365940511226654, "entropy": 19.57916259765625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 120000, "episodes_total": 2544, "training_iteration": 75, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_11-32-45", "timestamp": 1619494365, "time_this_iter_s": 1648.1952068805695, "time_total_s": 129398.51667952538, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 12737.25013422966, "timesteps_since_restore": 12800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 83.40629519353467, "ram_util_percent": 64.514164185453}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.9339152287274, "episode_reward_min": -1452.469048523305, "episode_reward_mean": -829.7021569694002, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6938.6847468108035, "mean_processing_ms": 643.6994011233805, "mean_inference_ms": 2.198769363943492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 117876, "num_steps_sampled": 121600, "sample_time_ms": 1595674.705, "load_time_ms": 42.213, "grad_time_ms": 802.494, "update_time_ms": 343.653, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 42978.640625, "policy_loss": -0.11569488793611526, "vf_loss": 42978.73828125, "vf_explained_var": 0.29855823516845703, "kl": 0.03188838064670563, "entropy": 19.583824157714844, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 121600, "episodes_total": 2576, "training_iteration": 76, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_12-00-00", "timestamp": 1619496000, "time_this_iter_s": 1634.9102456569672, "time_total_s": 131033.42692518234, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14372.160379886627, "timesteps_since_restore": 14400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 84.6622641509434, "ram_util_percent": 65.40583190394513}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.53826461186094, "episode_reward_min": -1452.469048523305, "episode_reward_mean": -828.7530618387578, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6948.647848446773, "mean_processing_ms": 648.7240402325132, "mean_inference_ms": 2.191422562271508}, "off_policy_estimator": {}, "info": {"num_steps_trained": 119427, "num_steps_sampled": 123200, "sample_time_ms": 1593383.35, "load_time_ms": 40.419, "grad_time_ms": 792.687, "update_time_ms": 310.099, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 39069.8203125, "policy_loss": -0.11769848316907883, "vf_loss": 39069.9296875, "vf_explained_var": 0.30681508779525757, "kl": 0.028415262699127197, "entropy": 19.41271209716797, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 123200, "episodes_total": 2608, "training_iteration": 77, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_12-26-13", "timestamp": 1619497573, "time_this_iter_s": 1573.5163910388947, "time_total_s": 132606.94331622124, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 15945.676770925522, "timesteps_since_restore": 16000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.74741532976827, "ram_util_percent": 66.39777183600712}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.53826461186094, "episode_reward_min": -4562.406120256144, "episode_reward_mean": -870.9507052187594, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6961.521213692531, "mean_processing_ms": 648.9009977386048, "mean_inference_ms": 2.184397684643322}, "off_policy_estimator": {}, "info": {"num_steps_trained": 120978, "num_steps_sampled": 124800, "sample_time_ms": 1582178.131, "load_time_ms": 13.769, "grad_time_ms": 696.042, "update_time_ms": 11.987, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 98589.75, "policy_loss": -0.09932863712310791, "vf_loss": 98589.84375, "vf_explained_var": 0.21855831146240234, "kl": 0.02613278478384018, "entropy": 19.388734817504883, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 124800, "episodes_total": 2640, "training_iteration": 78, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_12-52-50", "timestamp": 1619499170, "time_this_iter_s": 1596.5507650375366, "time_total_s": 134203.49408125877, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 17542.22753596306, "timesteps_since_restore": 17600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 86.53530961791832, "ram_util_percent": 67.11317523056654}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.53826461186094, "episode_reward_min": -4562.406120256144, "episode_reward_mean": -896.1297110354068, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6981.347074956414, "mean_processing_ms": 649.7372795720883, "mean_inference_ms": 2.17585171911829}, "off_policy_estimator": {}, "info": {"num_steps_trained": 122529, "num_steps_sampled": 126400, "sample_time_ms": 1595981.43, "load_time_ms": 13.721, "grad_time_ms": 699.108, "update_time_ms": 11.599, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 38804.01171875, "policy_loss": -0.12048452347517014, "vf_loss": 38804.12109375, "vf_explained_var": 0.31366845965385437, "kl": 0.029882503673434258, "entropy": 19.343050003051758, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 126400, "episodes_total": 2680, "training_iteration": 79, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_13-20-07", "timestamp": 1619500807, "time_this_iter_s": 1636.7787742614746, "time_total_s": 135840.27285552025, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19179.006310224533, "timesteps_since_restore": 19200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 86.08483940042825, "ram_util_percent": 67.74796573875803}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -395.2106942279897, "episode_reward_min": -4562.406120256144, "episode_reward_mean": -901.7609974624107, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7004.095382616592, "mean_processing_ms": 652.0673242212288, "mean_inference_ms": 2.1693436837958173}, "off_policy_estimator": {}, "info": {"num_steps_trained": 124080, "num_steps_sampled": 128000, "sample_time_ms": 1612048.804, "load_time_ms": 13.241, "grad_time_ms": 696.931, "update_time_ms": 11.477, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 46438.6328125, "policy_loss": -0.1312928944826126, "vf_loss": 46438.75390625, "vf_explained_var": 0.29729163646698, "kl": 0.031644050031900406, "entropy": 19.359621047973633, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 128000, "episodes_total": 2712, "training_iteration": 80, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_13-47-55", "timestamp": 1619502475, "time_this_iter_s": 1668.539574623108, "time_total_s": 137508.81243014336, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 20847.54588484764, "timesteps_since_restore": 20800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 84.4902059688945, "ram_util_percent": 68.6197141656158}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.3499299684972, "episode_reward_min": -1279.6217952299003, "episode_reward_mean": -856.86532068679, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7015.98950463328, "mean_processing_ms": 655.1242949452712, "mean_inference_ms": 2.16459232240786}, "off_policy_estimator": {}, "info": {"num_steps_trained": 125631, "num_steps_sampled": 129600, "sample_time_ms": 1609093.006, "load_time_ms": 13.396, "grad_time_ms": 699.266, "update_time_ms": 11.287, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 34206.6953125, "policy_loss": -0.11566001921892166, "vf_loss": 34206.80078125, "vf_explained_var": 0.32233670353889465, "kl": 0.028975099325180054, "entropy": 19.0982723236084, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 129600, "episodes_total": 2744, "training_iteration": 81, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_14-14-15", "timestamp": 1619504055, "time_this_iter_s": 1580.0229053497314, "time_total_s": 139088.8353354931, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 22427.568790197372, "timesteps_since_restore": 22400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 84.6429902395741, "ram_util_percent": 69.52382431233363}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.3499299684972, "episode_reward_min": -1279.6217952299003, "episode_reward_mean": -829.8851595298298, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7015.981724310408, "mean_processing_ms": 654.6721024059494, "mean_inference_ms": 2.1617603985963765}, "off_policy_estimator": {}, "info": {"num_steps_trained": 127182, "num_steps_sampled": 131200, "sample_time_ms": 1604196.822, "load_time_ms": 13.765, "grad_time_ms": 703.319, "update_time_ms": 11.718, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 35904.27734375, "policy_loss": -0.11217889934778214, "vf_loss": 35904.3828125, "vf_explained_var": 0.3182018995285034, "kl": 0.029216311872005463, "entropy": 18.972434997558594, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 131200, "episodes_total": 2776, "training_iteration": 82, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_14-40-30", "timestamp": 1619505630, "time_this_iter_s": 1574.044186115265, "time_total_s": 140662.87952160835, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24001.612976312637, "timesteps_since_restore": 24000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 83.10017817371937, "ram_util_percent": 70.3057461024499}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.3499299684972, "episode_reward_min": -1261.5004712146253, "episode_reward_mean": -814.605133599556, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7014.404183616555, "mean_processing_ms": 656.4227018151654, "mean_inference_ms": 2.1590232643096403}, "off_policy_estimator": {}, "info": {"num_steps_trained": 128733, "num_steps_sampled": 132800, "sample_time_ms": 1617181.488, "load_time_ms": 13.614, "grad_time_ms": 708.51, "update_time_ms": 11.866, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 42175.890625, "policy_loss": -0.12566448748111725, "vf_loss": 42176.00390625, "vf_explained_var": 0.3210828900337219, "kl": 0.031024577096104622, "entropy": 18.958255767822266, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 132800, "episodes_total": 2816, "training_iteration": 83, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_15-08-51", "timestamp": 1619507331, "time_this_iter_s": 1701.7331731319427, "time_total_s": 142364.6126947403, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25703.34614944458, "timesteps_since_restore": 25600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 83.85764318088175, "ram_util_percent": 71.23827770910589}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.00600321054003, "episode_reward_min": -1261.5004712146253, "episode_reward_mean": -797.5855310104371, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7017.346604808483, "mean_processing_ms": 658.3327329158549, "mean_inference_ms": 2.1577751819069517}, "off_policy_estimator": {}, "info": {"num_steps_trained": 130284, "num_steps_sampled": 134400, "sample_time_ms": 1624769.605, "load_time_ms": 14.163, "grad_time_ms": 702.04, "update_time_ms": 11.462, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 40074.97265625, "policy_loss": -0.12114226818084717, "vf_loss": 40075.08984375, "vf_explained_var": 0.3158826529979706, "kl": 0.028320370241999626, "entropy": 18.901227951049805, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 134400, "episodes_total": 2848, "training_iteration": 84, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_15-36-12", "timestamp": 1619508972, "time_this_iter_s": 1640.8812000751495, "time_total_s": 144005.49389481544, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27344.22734951973, "timesteps_since_restore": 27200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 84.90910256410255, "ram_util_percent": 72.02688034188036}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.00600321054003, "episode_reward_min": -1245.8378705040775, "episode_reward_mean": -810.7195602631477, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7024.465250704809, "mean_processing_ms": 659.9518274588314, "mean_inference_ms": 2.1565404708882228}, "off_policy_estimator": {}, "info": {"num_steps_trained": 131835, "num_steps_sampled": 136000, "sample_time_ms": 1623452.334, "load_time_ms": 14.302, "grad_time_ms": 700.718, "update_time_ms": 10.785, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 33641.671875, "policy_loss": -0.11683749407529831, "vf_loss": 33641.77734375, "vf_explained_var": 0.3371187448501587, "kl": 0.029659099876880646, "entropy": 18.693805694580078, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 136000, "episodes_total": 2880, "training_iteration": 85, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_16-03-27", "timestamp": 1619510607, "time_this_iter_s": 1635.0053451061249, "time_total_s": 145640.49923992157, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28979.232694625854, "timesteps_since_restore": 28800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 82.70600343053174, "ram_util_percent": 73.06020583190396}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.6436849733406, "episode_reward_min": -1256.19958256932, "episode_reward_mean": -800.496010582856, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7025.782677663027, "mean_processing_ms": 661.1160639664695, "mean_inference_ms": 2.155724441755487}, "off_policy_estimator": {}, "info": {"num_steps_trained": 133386, "num_steps_sampled": 137600, "sample_time_ms": 1621831.632, "load_time_ms": 14.403, "grad_time_ms": 703.429, "update_time_ms": 10.081, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 28270.8203125, "policy_loss": -0.11143345385789871, "vf_loss": 28270.919921875, "vf_explained_var": 0.3676449656486511, "kl": 0.028072373941540718, "entropy": 18.6607666015625, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 137600, "episodes_total": 2912, "training_iteration": 86, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_16-30-26", "timestamp": 1619512226, "time_this_iter_s": 1618.7233548164368, "time_total_s": 147259.222594738, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30597.95604944229, "timesteps_since_restore": 30400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 82.98618449545256, "ram_util_percent": 73.69878735383283}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.50305078870815, "episode_reward_min": -1306.0771007944008, "episode_reward_mean": -783.44236292563, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7029.06782356774, "mean_processing_ms": 664.82468490803, "mean_inference_ms": 2.153011900689835}, "off_policy_estimator": {}, "info": {"num_steps_trained": 134937, "num_steps_sampled": 139200, "sample_time_ms": 1632678.358, "load_time_ms": 13.207, "grad_time_ms": 700.593, "update_time_ms": 10.293, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 37947.96875, "policy_loss": -0.12899889051914215, "vf_loss": 37948.08984375, "vf_explained_var": 0.3465011715888977, "kl": 0.02952151745557785, "entropy": 18.66584587097168, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 139200, "episodes_total": 2952, "training_iteration": 87, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_16-58-28", "timestamp": 1619513908, "time_this_iter_s": 1681.9452784061432, "time_total_s": 148941.16787314415, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 32279.901327848434, "timesteps_since_restore": 32000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 85.41696540225095, "ram_util_percent": 74.30662776156731}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.50305078870815, "episode_reward_min": -4499.736317522102, "episode_reward_mean": -855.3687633291655, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7041.271810948083, "mean_processing_ms": 666.6337504661747, "mean_inference_ms": 2.1513798993652866}, "off_policy_estimator": {}, "info": {"num_steps_trained": 136488, "num_steps_sampled": 140800, "sample_time_ms": 1643375.938, "load_time_ms": 13.289, "grad_time_ms": 698.173, "update_time_ms": 10.133, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 100029.2734375, "policy_loss": -0.09977922588586807, "vf_loss": 100029.3515625, "vf_explained_var": 0.23107093572616577, "kl": 0.028556348755955696, "entropy": 18.671598434448242, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 140800, "episodes_total": 2984, "training_iteration": 88, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_17-26-52", "timestamp": 1619515612, "time_this_iter_s": 1703.4996993541718, "time_total_s": 150644.66757249832, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33983.401027202606, "timesteps_since_restore": 33600, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 85.82877727459861, "ram_util_percent": 75.60852202552489}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.50305078870815, "episode_reward_min": -4499.736317522102, "episode_reward_mean": -884.009865793168, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7052.178572896593, "mean_processing_ms": 667.4774885961684, "mean_inference_ms": 2.150476422695795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 138039, "num_steps_sampled": 142400, "sample_time_ms": 1638658.895, "load_time_ms": 13.247, "grad_time_ms": 694.612, "update_time_ms": 9.927, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 35779.90234375, "policy_loss": -0.10690732300281525, "vf_loss": 35779.99609375, "vf_explained_var": 0.3376861810684204, "kl": 0.02604914829134941, "entropy": 18.43327522277832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 142400, "episodes_total": 3016, "training_iteration": 89, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_17-53-21", "timestamp": 1619517201, "time_this_iter_s": 1589.5700888633728, "time_total_s": 152234.2376613617, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35572.97111606598, "timesteps_since_restore": 35200, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 84.3579365079365, "ram_util_percent": 76.37958553791887}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -394.4988939456641, "episode_reward_min": -4499.736317522102, "episode_reward_mean": -905.9264860151271, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7062.818210218863, "mean_processing_ms": 665.2801755751393, "mean_inference_ms": 2.1506147989462416}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139590, "num_steps_sampled": 144000, "sample_time_ms": 1637193.816, "load_time_ms": 13.137, "grad_time_ms": 699.804, "update_time_ms": 9.894, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 47783.84765625, "policy_loss": -0.1153232529759407, "vf_loss": 47783.94921875, "vf_explained_var": 0.3109973073005676, "kl": 0.028067804872989655, "entropy": 18.412866592407227, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 144000, "episodes_total": 3048, "training_iteration": 90, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_18-20-55", "timestamp": 1619518855, "time_this_iter_s": 1653.943135023117, "time_total_s": 153888.1807963848, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 37226.914251089096, "timesteps_since_restore": 36800, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 84.55173876166242, "ram_util_percent": 76.87052586938084}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.4888365651672, "episode_reward_min": -1264.3158500010024, "episode_reward_mean": -883.6590913322799, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7073.336679903362, "mean_processing_ms": 665.6710303812185, "mean_inference_ms": 2.1496915716283023}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141141, "num_steps_sampled": 145600, "sample_time_ms": 1653507.79, "load_time_ms": 13.337, "grad_time_ms": 695.837, "update_time_ms": 9.953, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 48645.9375, "policy_loss": -0.1230248436331749, "vf_loss": 48646.05078125, "vf_explained_var": 0.33766061067581177, "kl": 0.0312541127204895, "entropy": 18.416484832763672, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 145600, "episodes_total": 3088, "training_iteration": 91, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_18-49-58", "timestamp": 1619520598, "time_this_iter_s": 1743.1308870315552, "time_total_s": 155631.31168341637, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38970.04513812065, "timesteps_since_restore": 38400, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 85.26775231202252, "ram_util_percent": 77.4416164053076}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.6360402760918, "episode_reward_min": -1277.8071982874453, "episode_reward_mean": -866.4015721858955, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7082.0338280372325, "mean_processing_ms": 666.4561641590217, "mean_inference_ms": 2.1492485714926453}, "off_policy_estimator": {}, "info": {"num_steps_trained": 142692, "num_steps_sampled": 147200, "sample_time_ms": 1660249.22, "load_time_ms": 13.149, "grad_time_ms": 694.745, "update_time_ms": 9.345, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 35649.6171875, "policy_loss": -0.1137598529458046, "vf_loss": 35649.72265625, "vf_explained_var": 0.3509419560432434, "kl": 0.02415592037141323, "entropy": 18.3095760345459, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 147200, "episodes_total": 3120, "training_iteration": 92, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_19-17-20", "timestamp": 1619522240, "time_this_iter_s": 1641.437507390976, "time_total_s": 157272.74919080734, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 40611.48264551163, "timesteps_since_restore": 40000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 84.06864587783, "ram_util_percent": 78.11465185818028}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.6360402760918, "episode_reward_min": -1420.0521309266603, "episode_reward_mean": -853.0814669228126, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7094.576298606906, "mean_processing_ms": 667.9579012125978, "mean_inference_ms": 2.1481636412301617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 144243, "num_steps_sampled": 148800, "sample_time_ms": 1720142.597, "load_time_ms": 13.506, "grad_time_ms": 701.425, "update_time_ms": 9.631, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 42060528.0, "policy_loss": -0.050374891608953476, "vf_loss": 42060528.0, "vf_explained_var": 0.05618103966116905, "kl": 0.01668001525104046, "entropy": 18.272565841674805, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 148800, "episodes_total": 3152, "training_iteration": 93, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_19-55-41", "timestamp": 1619524541, "time_this_iter_s": 2300.7325236797333, "time_total_s": 159573.48171448708, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 42912.21516919136, "timesteps_since_restore": 41600, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 64.89500152392563, "ram_util_percent": 80.06732703444072}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -386.56067185576984, "episode_reward_min": -161362.5535896577, "episode_reward_mean": -2435.3208629125656, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7101.956049439312, "mean_processing_ms": 667.4127340344976, "mean_inference_ms": 2.148231105903019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 145794, "num_steps_sampled": 150400, "sample_time_ms": 1754736.201, "load_time_ms": 12.854, "grad_time_ms": 708.621, "update_time_ms": 9.534, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 9580107.0, "policy_loss": -0.035487767308950424, "vf_loss": 9580107.0, "vf_explained_var": 0.07809529453516006, "kl": 0.014337936416268349, "entropy": 18.207334518432617, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 150400, "episodes_total": 3184, "training_iteration": 94, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_20-28-48", "timestamp": 1619526528, "time_this_iter_s": 1986.87904214859, "time_total_s": 161560.36075663567, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 44899.09421133995, "timesteps_since_restore": 43200, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 72.57920931874338, "ram_util_percent": 82.49894105188845}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -386.56067185576984, "episode_reward_min": -161362.5535896577, "episode_reward_mean": -2402.8508132839256, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7119.040544336111, "mean_processing_ms": 669.5698219687556, "mean_inference_ms": 2.1466848241617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 147345, "num_steps_sampled": 152000, "sample_time_ms": 1763847.25, "load_time_ms": 12.742, "grad_time_ms": 708.895, "update_time_ms": 9.619, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 34943.52734375, "policy_loss": -0.12141551822423935, "vf_loss": 34943.63671875, "vf_explained_var": 0.3798292875289917, "kl": 0.028608256950974464, "entropy": 18.223588943481445, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 152000, "episodes_total": 3224, "training_iteration": 95, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_20-57-34", "timestamp": 1619528254, "time_this_iter_s": 1726.1169745922089, "time_total_s": 163286.47773122787, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 46625.21118593216, "timesteps_since_restore": 44800, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 86.08290008123475, "ram_util_percent": 81.97201462225831}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -386.56067185576984, "episode_reward_min": -161362.5535896577, "episode_reward_mean": -2375.0331430615993, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7130.955577387404, "mean_processing_ms": 671.3770497744902, "mean_inference_ms": 2.146207805678868}, "off_policy_estimator": {}, "info": {"num_steps_trained": 148896, "num_steps_sampled": 153600, "sample_time_ms": 1806285.544, "load_time_ms": 12.618, "grad_time_ms": 713.811, "update_time_ms": 9.878, "learner": {"default_policy": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 0.0006000000284984708, "total_loss": 12807444.0, "policy_loss": -0.034651320427656174, "vf_loss": 12807444.0, "vf_explained_var": 0.08909651637077332, "kl": 0.013122581876814365, "entropy": 18.15084457397461, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 153600, "episodes_total": 3256, "training_iteration": 96, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_21-31-37", "timestamp": 1619530297, "time_this_iter_s": 2043.1561274528503, "time_total_s": 165329.63385868073, "pid": 3404293, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 48668.36731338501, "timesteps_since_restore": 46400, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 72.1477693891558, "ram_util_percent": 83.15010295126973}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -394.9812344457118, "episode_reward_min": -44262.230169060495, "episode_reward_mean": -9764.927650819605, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7257.6627253893, "mean_processing_ms": 628.9537540122644, "mean_inference_ms": 2.8040668561090873}, "off_policy_estimator": {}, "info": {"num_steps_trained": 150447, "num_steps_sampled": 155200, "sample_time_ms": 1680750.335, "load_time_ms": 272.187, "grad_time_ms": 1694.252, "update_time_ms": 3037.555, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 25785972.0, "policy_loss": -0.06678415089845657, "vf_loss": 25785972.0, "vf_explained_var": 0.011482981033623219, "kl": 0.02585616521537304, "entropy": 18.130043029785156, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 155200, "episodes_total": 3288, "training_iteration": 97, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_22-24-22", "timestamp": 1619533462, "time_this_iter_s": 1685.960832118988, "time_total_s": 167015.5946907997, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1685.960832118988, "timesteps_since_restore": 1600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 80.7770157938487, "ram_util_percent": 54.051662510390685}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.23832686615816, "episode_reward_min": -44262.230169060495, "episode_reward_mean": -5247.595493447072, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7100.0498397467, "mean_processing_ms": 620.1334657376934, "mean_inference_ms": 2.6371253521273426}, "off_policy_estimator": {}, "info": {"num_steps_trained": 151998, "num_steps_sampled": 156800, "sample_time_ms": 1595119.755, "load_time_ms": 142.312, "grad_time_ms": 1182.97, "update_time_ms": 1524.257, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 33935.5625, "policy_loss": -0.11402036994695663, "vf_loss": 33935.671875, "vf_explained_var": 0.3674655258655548, "kl": 0.029586942866444588, "entropy": 17.870698928833008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 156800, "episodes_total": 3320, "training_iteration": 98, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_22-49-33", "timestamp": 1619534973, "time_this_iter_s": 1510.203697681427, "time_total_s": 168525.79838848114, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3196.164529800415, "timesteps_since_restore": 3200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 84.50487465181058, "ram_util_percent": 58.526415970287836}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.23832686615816, "episode_reward_min": -44262.230169060495, "episode_reward_mean": -3800.8115213492442, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7067.719976162795, "mean_processing_ms": 620.7847559484745, "mean_inference_ms": 2.5400974992958365}, "off_policy_estimator": {}, "info": {"num_steps_trained": 153549, "num_steps_sampled": 158400, "sample_time_ms": 1604039.101, "load_time_ms": 100.67, "grad_time_ms": 1023.943, "update_time_ms": 1020.951, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 36204.28515625, "policy_loss": -0.1295114904642105, "vf_loss": 36204.40234375, "vf_explained_var": 0.39942502975463867, "kl": 0.038128066807985306, "entropy": 17.875608444213867, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 158400, "episodes_total": 3352, "training_iteration": 99, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_23-16-35", "timestamp": 1619536595, "time_this_iter_s": 1622.6344623565674, "time_total_s": 170148.4328508377, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4818.798992156982, "timesteps_since_restore": 4800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 84.28383751080379, "ram_util_percent": 60.06789109766637}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.23832686615816, "episode_reward_min": -1223.2659590541584, "episode_reward_mean": -812.9848236824262, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 6987.594948951071, "mean_processing_ms": 639.2341690007546, "mean_inference_ms": 2.3525998281492497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 155100, "num_steps_sampled": 160000, "sample_time_ms": 1620403.705, "load_time_ms": 78.427, "grad_time_ms": 934.587, "update_time_ms": 768.729, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 30868.939453125, "policy_loss": -0.11650404334068298, "vf_loss": 30869.048828125, "vf_explained_var": 0.40685880184173584, "kl": 0.039194926619529724, "entropy": 17.743913650512695, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 160000, "episodes_total": 3392, "training_iteration": 100, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-27_23-44-26", "timestamp": 1619538266, "time_this_iter_s": 1670.2074401378632, "time_total_s": 171818.64029097557, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6489.006432294846, "timesteps_since_restore": 6400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 83.41771620486986, "ram_util_percent": 61.4201931150294}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.9298372044472, "episode_reward_min": -1325.5286133105606, "episode_reward_mean": -834.5250745997258, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7051.820564212015, "mean_processing_ms": 655.310507063952, "mean_inference_ms": 2.2854403912689385}, "off_policy_estimator": {}, "info": {"num_steps_trained": 156651, "num_steps_sampled": 161600, "sample_time_ms": 1633965.236, "load_time_ms": 65.515, "grad_time_ms": 890.814, "update_time_ms": 617.268, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 43099.00390625, "policy_loss": -0.12062663584947586, "vf_loss": 43099.12109375, "vf_explained_var": 0.37568217515945435, "kl": 0.03739011287689209, "entropy": 17.76186752319336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 161600, "episodes_total": 3424, "training_iteration": 101, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_00-12-35", "timestamp": 1619539955, "time_this_iter_s": 1688.9700899124146, "time_total_s": 173507.61038088799, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8177.97652220726, "timesteps_since_restore": 8000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 85.8717310087173, "ram_util_percent": 62.59016189290163}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.49791698801306, "episode_reward_min": -1325.5286133105606, "episode_reward_mean": -791.9576418182564, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7074.02838436058, "mean_processing_ms": 668.5912977417006, "mean_inference_ms": 2.2496978243456844}, "off_policy_estimator": {}, "info": {"num_steps_trained": 158202, "num_steps_sampled": 163200, "sample_time_ms": 1623028.056, "load_time_ms": 57.49, "grad_time_ms": 863.436, "update_time_ms": 517.356, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 23969.880859375, "policy_loss": -0.10763843357563019, "vf_loss": 23969.98046875, "vf_explained_var": 0.4268556833267212, "kl": 0.02798444591462612, "entropy": 17.45842933654785, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 163200, "episodes_total": 3456, "training_iteration": 102, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_00-38-44", "timestamp": 1619541524, "time_this_iter_s": 1569.1205430030823, "time_total_s": 175076.73092389107, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9747.097065210342, "timesteps_since_restore": 9600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 83.65129579982126, "ram_util_percent": 63.689008042895445}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.49791698801306, "episode_reward_min": -1325.5286133105606, "episode_reward_mean": -782.323838643528, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7101.554198185989, "mean_processing_ms": 669.5407694425501, "mean_inference_ms": 2.230244604719028}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159753, "num_steps_sampled": 164800, "sample_time_ms": 1622608.606, "load_time_ms": 53.073, "grad_time_ms": 833.9, "update_time_ms": 445.57, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 30823.169921875, "policy_loss": -0.12071871757507324, "vf_loss": 30823.28125, "vf_explained_var": 0.4073489010334015, "kl": 0.03417854383587837, "entropy": 17.416385650634766, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 164800, "episodes_total": 3488, "training_iteration": 103, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_01-05-45", "timestamp": 1619543145, "time_this_iter_s": 1620.8130559921265, "time_total_s": 176697.5439798832, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11367.910121202469, "timesteps_since_restore": 11200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 83.41016435986158, "ram_util_percent": 64.89671280276818}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.49791698801306, "episode_reward_min": -1252.625941981318, "episode_reward_mean": -759.9569806363685, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7064.660782908936, "mean_processing_ms": 674.6321652522482, "mean_inference_ms": 2.2124215212155973}, "off_policy_estimator": {}, "info": {"num_steps_trained": 161304, "num_steps_sampled": 166400, "sample_time_ms": 1624597.155, "load_time_ms": 48.07, "grad_time_ms": 807.439, "update_time_ms": 390.938, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 29801.26953125, "policy_loss": -0.10964512079954147, "vf_loss": 29801.369140625, "vf_explained_var": 0.40459737181663513, "kl": 0.03357316553592682, "entropy": 17.38400650024414, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 166400, "episodes_total": 3528, "training_iteration": 104, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_01-33-04", "timestamp": 1619544784, "time_this_iter_s": 1639.178079366684, "time_total_s": 178336.72205924988, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13007.088200569153, "timesteps_since_restore": 12800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 84.42480752780155, "ram_util_percent": 65.70038494439692}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.934353147554, "episode_reward_min": -1252.625941981318, "episode_reward_mean": -829.8073328371672, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7085.158558197044, "mean_processing_ms": 676.2978919743274, "mean_inference_ms": 2.2033852825639095}, "off_policy_estimator": {}, "info": {"num_steps_trained": 162855, "num_steps_sampled": 168000, "sample_time_ms": 1636411.885, "load_time_ms": 44.511, "grad_time_ms": 790.447, "update_time_ms": 349.17, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 105778.8828125, "policy_loss": -0.10127539932727814, "vf_loss": 105778.96875, "vf_explained_var": 0.27655699849128723, "kl": 0.03298554569482803, "entropy": 17.45564842224121, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 168000, "episodes_total": 3560, "training_iteration": 105, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_02-01-56", "timestamp": 1619546516, "time_this_iter_s": 1731.6324660778046, "time_total_s": 180068.35452532768, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14738.720666646957, "timesteps_since_restore": 14400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 85.70968003240179, "ram_util_percent": 66.94345889023897}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.4434175432517, "episode_reward_min": -4696.591393932043, "episode_reward_mean": -881.7702244943371, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7112.36809854778, "mean_processing_ms": 677.9751928615235, "mean_inference_ms": 2.1956315412606413}, "off_policy_estimator": {}, "info": {"num_steps_trained": 164406, "num_steps_sampled": 169600, "sample_time_ms": 1637291.034, "load_time_ms": 41.08, "grad_time_ms": 777.983, "update_time_ms": 315.017, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 27989.466796875, "policy_loss": -0.11088649928569794, "vf_loss": 27989.564453125, "vf_explained_var": 0.42077845335006714, "kl": 0.03732410818338394, "entropy": 17.134105682373047, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 169600, "episodes_total": 3592, "training_iteration": 106, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_02-29-21", "timestamp": 1619548161, "time_this_iter_s": 1645.9054441452026, "time_total_s": 181714.25996947289, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16384.62611079216, "timesteps_since_restore": 16000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.13087734241907, "ram_util_percent": 67.49033219761499}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.4434175432517, "episode_reward_min": -4696.591393932043, "episode_reward_mean": -887.12480018797, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7148.786286187561, "mean_processing_ms": 675.1543855617483, "mean_inference_ms": 2.18985515949454}, "off_policy_estimator": {}, "info": {"num_steps_trained": 165957, "num_steps_sampled": 171200, "sample_time_ms": 1630852.105, "load_time_ms": 14.998, "grad_time_ms": 674.661, "update_time_ms": 12.43, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 36932.66015625, "policy_loss": -0.11032050102949142, "vf_loss": 36932.76171875, "vf_explained_var": 0.3821293115615845, "kl": 0.033678051084280014, "entropy": 17.092741012573242, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 171200, "episodes_total": 3624, "training_iteration": 107, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_02-56-19", "timestamp": 1619549779, "time_this_iter_s": 1617.060890197754, "time_total_s": 183331.32085967064, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18001.687000989914, "timesteps_since_restore": 17600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 84.56795316565481, "ram_util_percent": 68.02640936686905}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.32625819311625, "episode_reward_min": -4696.591393932043, "episode_reward_mean": -893.1424219912186, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7151.239242562263, "mean_processing_ms": 674.8362684124535, "mean_inference_ms": 2.183197184510177}, "off_policy_estimator": {}, "info": {"num_steps_trained": 167508, "num_steps_sampled": 172800, "sample_time_ms": 1652207.537, "load_time_ms": 15.216, "grad_time_ms": 675.029, "update_time_ms": 12.878, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 41997.2890625, "policy_loss": -0.11915922909975052, "vf_loss": 41997.3984375, "vf_explained_var": 0.3811491131782532, "kl": 0.034652795642614365, "entropy": 17.049903869628906, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 172800, "episodes_total": 3664, "training_iteration": 108, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_03-25-02", "timestamp": 1619551502, "time_this_iter_s": 1723.766135931015, "time_total_s": 185055.08699560165, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19725.45313692093, "timesteps_since_restore": 19200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 83.30593737291582, "ram_util_percent": 68.95933306222041}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.32625819311625, "episode_reward_min": -1290.9287068259614, "episode_reward_mean": -846.5862902648411, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7166.824068791035, "mean_processing_ms": 675.6614096538276, "mean_inference_ms": 2.179585147616129}, "off_policy_estimator": {}, "info": {"num_steps_trained": 169059, "num_steps_sampled": 174400, "sample_time_ms": 1664221.126, "load_time_ms": 14.97, "grad_time_ms": 674.476, "update_time_ms": 12.835, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 38489.484375, "policy_loss": -0.12819820642471313, "vf_loss": 38489.6015625, "vf_explained_var": 0.3884753882884979, "kl": 0.03415747731924057, "entropy": 17.048973083496094, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 174400, "episodes_total": 3696, "training_iteration": 109, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_03-54-05", "timestamp": 1619553245, "time_this_iter_s": 1742.7609913349152, "time_total_s": 186797.84798693657, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21468.214128255844, "timesteps_since_restore": 20800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 84.10792756539236, "ram_util_percent": 70.09995975855131}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.28937203972527, "episode_reward_min": -1290.9287068259614, "episode_reward_mean": -876.8831996863289, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7186.815265523079, "mean_processing_ms": 677.4006208644978, "mean_inference_ms": 2.1760082394381426}, "off_policy_estimator": {}, "info": {"num_steps_trained": 170610, "num_steps_sampled": 176000, "sample_time_ms": 1664779.845, "load_time_ms": 15.068, "grad_time_ms": 678.935, "update_time_ms": 12.853, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 34087.875, "policy_loss": -0.11888274550437927, "vf_loss": 34087.98828125, "vf_explained_var": 0.4072686433792114, "kl": 0.0342286080121994, "entropy": 16.819791793823242, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 176000, "episodes_total": 3728, "training_iteration": 110, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_04-22-01", "timestamp": 1619554921, "time_this_iter_s": 1675.840772151947, "time_total_s": 188473.68875908852, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23144.05490040779, "timesteps_since_restore": 22400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 84.88958158995815, "ram_util_percent": 71.16995815899583}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.28937203972527, "episode_reward_min": -125048.49332276185, "episode_reward_mean": -2105.2267692838873, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7241.917895439837, "mean_processing_ms": 678.7258092563602, "mean_inference_ms": 2.1746171781578907}, "off_policy_estimator": {}, "info": {"num_steps_trained": 172161, "num_steps_sampled": 177600, "sample_time_ms": 1777150.359, "load_time_ms": 14.935, "grad_time_ms": 681.075, "update_time_ms": 12.797, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 160571504.0, "policy_loss": -0.08270365744829178, "vf_loss": 160571504.0, "vf_explained_var": 0.006050971336662769, "kl": 0.0322081632912159, "entropy": 16.850675582885742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 177600, "episodes_total": 3760, "training_iteration": 111, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_05-08-54", "timestamp": 1619557734, "time_this_iter_s": 2812.7009353637695, "time_total_s": 191286.3896944523, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 25956.75583577156, "timesteps_since_restore": 24000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 61.61734795613161, "ram_util_percent": 74.31517946161516}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -389.28937203972527, "episode_reward_min": -177364.0557192561, "episode_reward_mean": -3889.980240798187, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7288.610564124126, "mean_processing_ms": 681.5320085130219, "mean_inference_ms": 2.172143567426148}, "off_policy_estimator": {}, "info": {"num_steps_trained": 173712, "num_steps_sampled": 179200, "sample_time_ms": 1820882.986, "load_time_ms": 14.803, "grad_time_ms": 680.699, "update_time_ms": 12.016, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 2031134.875, "policy_loss": -0.03562641143798828, "vf_loss": 2031135.125, "vf_explained_var": 0.10506293177604675, "kl": 0.015502839349210262, "entropy": 16.765140533447266, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 179200, "episodes_total": 3800, "training_iteration": 112, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_05-42-20", "timestamp": 1619559740, "time_this_iter_s": 2006.4383363723755, "time_total_s": 193292.82803082466, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 27963.194172143936, "timesteps_since_restore": 25600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 74.6859140160783, "ram_util_percent": 75.10775952464174}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.94782253538375, "episode_reward_min": -177364.0557192561, "episode_reward_mean": -2616.5535387874347, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7310.610081620811, "mean_processing_ms": 685.4142139265427, "mean_inference_ms": 2.1701086588391814}, "off_policy_estimator": {}, "info": {"num_steps_trained": 175263, "num_steps_sampled": 180800, "sample_time_ms": 1830584.104, "load_time_ms": 13.327, "grad_time_ms": 687.807, "update_time_ms": 11.901, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 30429.8359375, "policy_loss": -0.12269007414579391, "vf_loss": 30429.951171875, "vf_explained_var": 0.43025436997413635, "kl": 0.032441310584545135, "entropy": 16.75146484375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 180800, "episodes_total": 3832, "training_iteration": 113, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_06-10-58", "timestamp": 1619561458, "time_this_iter_s": 1717.876169204712, "time_total_s": 195010.70420002937, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 29681.070341348648, "timesteps_since_restore": 27200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 84.12967346938775, "ram_util_percent": 75.68681632653062}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.0135381312598, "episode_reward_min": -177364.0557192561, "episode_reward_mean": -2621.6622612788196, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7321.441513043645, "mean_processing_ms": 687.7720362831586, "mean_inference_ms": 2.1680408052964752}, "off_policy_estimator": {}, "info": {"num_steps_trained": 176814, "num_steps_sampled": 182400, "sample_time_ms": 1834126.64, "load_time_ms": 13.786, "grad_time_ms": 693.885, "update_time_ms": 12.113, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 42592.42578125, "policy_loss": -0.11841795593500137, "vf_loss": 42592.53515625, "vf_explained_var": 0.3898724317550659, "kl": 0.032392170280218124, "entropy": 16.562427520751953, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 182400, "episodes_total": 3864, "training_iteration": 114, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_06-38-53", "timestamp": 1619563133, "time_this_iter_s": 1674.6706557273865, "time_total_s": 196685.37485575676, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31355.740997076035, "timesteps_since_restore": 28800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 85.6638760987861, "ram_util_percent": 76.75403934700711}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.2836473857314, "episode_reward_min": -1369.9330174921097, "episode_reward_mean": -857.139997528337, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7337.596837894376, "mean_processing_ms": 689.5793581532774, "mean_inference_ms": 2.167395704915358}, "off_policy_estimator": {}, "info": {"num_steps_trained": 178365, "num_steps_sampled": 184000, "sample_time_ms": 1831167.29, "load_time_ms": 13.36, "grad_time_ms": 703.14, "update_time_ms": 11.58, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 32764.900390625, "policy_loss": -0.10936924815177917, "vf_loss": 32765.0, "vf_explained_var": 0.42661821842193604, "kl": 0.03255663067102432, "entropy": 16.47247314453125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 184000, "episodes_total": 3896, "training_iteration": 115, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_07-07-15", "timestamp": 1619564835, "time_this_iter_s": 1702.1240003108978, "time_total_s": 198387.49885606766, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 33057.86499738693, "timesteps_since_restore": 30400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 84.05893739703458, "ram_util_percent": 77.77948929159803}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.2836473857314, "episode_reward_min": -1369.9330174921097, "episode_reward_mean": -853.0192613119898, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7339.27030811169, "mean_processing_ms": 690.0670686236934, "mean_inference_ms": 2.164185925992694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179916, "num_steps_sampled": 185600, "sample_time_ms": 1842581.565, "load_time_ms": 13.744, "grad_time_ms": 714.178, "update_time_ms": 11.707, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 35088.58984375, "policy_loss": -0.12382285296916962, "vf_loss": 35088.703125, "vf_explained_var": 0.42582446336746216, "kl": 0.03975129500031471, "entropy": 16.40056610107422, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 185600, "episodes_total": 3936, "training_iteration": 116, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_07-36-35", "timestamp": 1619566595, "time_this_iter_s": 1760.1646387577057, "time_total_s": 200147.66349482536, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 34818.02963614464, "timesteps_since_restore": 32000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 84.77270916334662, "ram_util_percent": 78.3474501992032}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.2330479059345, "episode_reward_min": -1369.9330174921097, "episode_reward_mean": -832.6546365759715, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7348.26850724458, "mean_processing_ms": 693.5999146296876, "mean_inference_ms": 2.162311199923891}, "off_policy_estimator": {}, "info": {"num_steps_trained": 181467, "num_steps_sampled": 187200, "sample_time_ms": 1852112.127, "load_time_ms": 14.015, "grad_time_ms": 710.165, "update_time_ms": 11.722, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 31610.9765625, "policy_loss": -0.11641714721918106, "vf_loss": 31611.087890625, "vf_explained_var": 0.4207356572151184, "kl": 0.03598873317241669, "entropy": 16.404380798339844, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 187200, "episodes_total": 3968, "training_iteration": 117, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_08-05-08", "timestamp": 1619568308, "time_this_iter_s": 1712.3320071697235, "time_total_s": 201859.9955019951, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 36530.36164331436, "timesteps_since_restore": 33600, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 85.47944307944307, "ram_util_percent": 79.07436527436526}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.2330479059345, "episode_reward_min": -1275.0506584878474, "episode_reward_mean": -765.681267058631, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7352.005308546318, "mean_processing_ms": 696.690451658942, "mean_inference_ms": 2.1603080313514313}, "off_policy_estimator": {}, "info": {"num_steps_trained": 183018, "num_steps_sampled": 188800, "sample_time_ms": 1843392.454, "load_time_ms": 14.376, "grad_time_ms": 705.403, "update_time_ms": 11.664, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 24771.369140625, "policy_loss": -0.1078331470489502, "vf_loss": 24771.46875, "vf_explained_var": 0.4319302439689636, "kl": 0.028430694714188576, "entropy": 16.10533332824707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 188800, "episodes_total": 4000, "training_iteration": 118, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_08-32-24", "timestamp": 1619569944, "time_this_iter_s": 1636.5355870723724, "time_total_s": 203496.53108906746, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 38166.897230386734, "timesteps_since_restore": 35200, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 83.91066838046272, "ram_util_percent": 80.09254498714652}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -387.2330479059345, "episode_reward_min": -1275.0506584878474, "episode_reward_mean": -795.1443735997782, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7361.718654909862, "mean_processing_ms": 699.5127282954037, "mean_inference_ms": 2.159887791404456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 184569, "num_steps_sampled": 190400, "sample_time_ms": 1842999.217, "load_time_ms": 14.322, "grad_time_ms": 707.559, "update_time_ms": 12.064, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 36724.35546875, "policy_loss": -0.12267306447029114, "vf_loss": 36724.46875, "vf_explained_var": 0.4120512902736664, "kl": 0.03518572822213173, "entropy": 16.200223922729492, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 190400, "episodes_total": 4032, "training_iteration": 119, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_09-01-23", "timestamp": 1619571683, "time_this_iter_s": 1738.8552861213684, "time_total_s": 205235.38637518883, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 39905.7525165081, "timesteps_since_restore": 36800, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 84.51471774193548, "ram_util_percent": 81.06028225806452}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.31796008160075, "episode_reward_min": -4639.097301288649, "episode_reward_mean": -845.3472924642742, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7363.127127558657, "mean_processing_ms": 701.2126037807138, "mean_inference_ms": 2.1576495612244018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 186120, "num_steps_sampled": 192000, "sample_time_ms": 1854862.046, "load_time_ms": 14.225, "grad_time_ms": 704.932, "update_time_ms": 11.617, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 80984.03125, "policy_loss": -0.08291463553905487, "vf_loss": 80984.1015625, "vf_explained_var": 0.32561731338500977, "kl": 0.030333060771226883, "entropy": 16.104827880859375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 192000, "episodes_total": 4072, "training_iteration": 120, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_09-31-18", "timestamp": 1619573478, "time_this_iter_s": 1794.4338955879211, "time_total_s": 207029.82027077675, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 41700.18641209602, "timesteps_since_restore": 38400, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 84.928671875, "ram_util_percent": 81.2148046875}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.63808514571195, "episode_reward_min": -4639.097301288649, "episode_reward_mean": -834.5268074687888, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7367.873145669119, "mean_processing_ms": 704.4062775607189, "mean_inference_ms": 2.1568199687673553}, "off_policy_estimator": {}, "info": {"num_steps_trained": 187671, "num_steps_sampled": 193600, "sample_time_ms": 1739051.638, "load_time_ms": 14.365, "grad_time_ms": 702.507, "update_time_ms": 11.779, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 22651.2421875, "policy_loss": -0.10005560517311096, "vf_loss": 22651.337890625, "vf_explained_var": 0.44159287214279175, "kl": 0.025800060480833054, "entropy": 15.923019409179688, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 193600, "episodes_total": 4104, "training_iteration": 121, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_09-58-52", "timestamp": 1619575132, "time_this_iter_s": 1654.5678179264069, "time_total_s": 208684.38808870316, "pid": 3666235, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 43354.75423002243, "timesteps_since_restore": 40000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 83.83632895294616, "ram_util_percent": 82.13374311148792}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.29642289223034, "episode_reward_min": -40373.28052300679, "episode_reward_mean": -8291.577075433997, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7366.322479141292, "mean_processing_ms": 589.7553447467177, "mean_inference_ms": 2.761837854907287}, "off_policy_estimator": {}, "info": {"num_steps_trained": 189222, "num_steps_sampled": 195200, "sample_time_ms": 1691741.872, "load_time_ms": 330.285, "grad_time_ms": 1712.718, "update_time_ms": 3076.878, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 18636266.0, "policy_loss": -0.06178842484951019, "vf_loss": 18636266.0, "vf_explained_var": 0.01744987815618515, "kl": 0.022901661694049835, "entropy": 15.956799507141113, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 195200, "episodes_total": 4136, "training_iteration": 122, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_10-34-38", "timestamp": 1619577278, "time_this_iter_s": 1697.0734548568726, "time_total_s": 210381.46154356003, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1697.0734548568726, "timesteps_since_restore": 1600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 80.92679603633361, "ram_util_percent": 53.64962840627581}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.29642289223034, "episode_reward_min": -40373.28052300679, "episode_reward_mean": -4538.290298197195, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7220.46336930305, "mean_processing_ms": 612.8730765151583, "mean_inference_ms": 2.6047912433075524}, "off_policy_estimator": {}, "info": {"num_steps_trained": 190773, "num_steps_sampled": 196800, "sample_time_ms": 1616742.611, "load_time_ms": 170.563, "grad_time_ms": 1233.357, "update_time_ms": 1545.623, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 23591.556640625, "policy_loss": -0.12159032374620438, "vf_loss": 23591.669921875, "vf_explained_var": 0.46663370728492737, "kl": 0.03289159759879112, "entropy": 15.749579429626465, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 196800, "episodes_total": 4168, "training_iteration": 123, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_11-00-20", "timestamp": 1619578820, "time_this_iter_s": 1542.5398209095001, "time_total_s": 211924.00136446953, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3239.6132757663727, "timesteps_since_restore": 3200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 84.66240909090908, "ram_util_percent": 57.75427272727273}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.29642289223034, "episode_reward_min": -40373.28052300679, "episode_reward_mean": -3322.4896425807256, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7181.013580497073, "mean_processing_ms": 617.2844336256927, "mean_inference_ms": 2.5169151092231172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 192324, "num_steps_sampled": 198400, "sample_time_ms": 1618565.636, "load_time_ms": 117.886, "grad_time_ms": 1040.532, "update_time_ms": 1033.176, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 39892.546875, "policy_loss": -0.1192263811826706, "vf_loss": 39892.66015625, "vf_explained_var": 0.4074290096759796, "kl": 0.03476446866989136, "entropy": 15.777389526367188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 198400, "episodes_total": 4200, "training_iteration": 124, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_11-27-23", "timestamp": 1619580443, "time_this_iter_s": 1622.908502817154, "time_total_s": 213546.90986728668, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4862.521778583527, "timesteps_since_restore": 4800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 84.35049676025918, "ram_util_percent": 58.96976241900648}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -393.28016102807607, "episode_reward_min": -1239.22668247666, "episode_reward_mean": -835.8171439498531, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7083.494416633767, "mean_processing_ms": 646.6522667356253, "mean_inference_ms": 2.351637298007195}, "off_policy_estimator": {}, "info": {"num_steps_trained": 193875, "num_steps_sampled": 200000, "sample_time_ms": 1620811.758, "load_time_ms": 91.551, "grad_time_ms": 948.123, "update_time_ms": 777.001, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 31198.048828125, "policy_loss": -0.10929618030786514, "vf_loss": 31198.154296875, "vf_explained_var": 0.428775429725647, "kl": 0.030311917886137962, "entropy": 15.584423065185547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 200000, "episodes_total": 4240, "training_iteration": 125, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_11-54-32", "timestamp": 1619582072, "time_this_iter_s": 1628.260845899582, "time_total_s": 215175.17071318626, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6490.7826244831085, "timesteps_since_restore": 6400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 84.03191214470283, "ram_util_percent": 59.941903531438406}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.7397249103344, "episode_reward_min": -1227.8005251536995, "episode_reward_mean": -813.2852330207094, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7093.228787820833, "mean_processing_ms": 658.0280318357899, "mean_inference_ms": 2.2931816017357782}, "off_policy_estimator": {}, "info": {"num_steps_trained": 195426, "num_steps_sampled": 201600, "sample_time_ms": 1631867.46, "load_time_ms": 76.836, "grad_time_ms": 894.113, "update_time_ms": 624.111, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 34170.44140625, "policy_loss": -0.11424000561237335, "vf_loss": 34170.546875, "vf_explained_var": 0.4164426624774933, "kl": 0.036918189376592636, "entropy": 15.588235855102539, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 201600, "episodes_total": 4272, "training_iteration": 126, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_12-22-29", "timestamp": 1619583749, "time_this_iter_s": 1676.8157675266266, "time_total_s": 216851.9864807129, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 8167.598392009735, "timesteps_since_restore": 8000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 84.02520903010033, "ram_util_percent": 61.32445652173912}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.7397249103344, "episode_reward_min": -1223.3620770205525, "episode_reward_mean": -778.8011086998375, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7083.570826397323, "mean_processing_ms": 666.6996446451096, "mean_inference_ms": 2.2590922158502615}, "off_policy_estimator": {}, "info": {"num_steps_trained": 196977, "num_steps_sampled": 203200, "sample_time_ms": 1625077.5, "load_time_ms": 66.303, "grad_time_ms": 859.77, "update_time_ms": 521.849, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 29858.55078125, "policy_loss": -0.10485818237066269, "vf_loss": 29858.6484375, "vf_explained_var": 0.41515591740608215, "kl": 0.028948239982128143, "entropy": 15.320456504821777, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 203200, "episodes_total": 4304, "training_iteration": 127, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_12-49-00", "timestamp": 1619585340, "time_this_iter_s": 1591.860944032669, "time_total_s": 218443.84742474556, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 9759.459336042404, "timesteps_since_restore": 9600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 83.195859030837, "ram_util_percent": 62.334140969162995}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.7397249103344, "episode_reward_min": -1296.108244058224, "episode_reward_mean": -790.0339361813884, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7090.124380442496, "mean_processing_ms": 662.2928021350916, "mean_inference_ms": 2.233284738859941}, "off_policy_estimator": {}, "info": {"num_steps_trained": 198528, "num_steps_sampled": 204800, "sample_time_ms": 1622222.698, "load_time_ms": 58.76, "grad_time_ms": 836.62, "update_time_ms": 449.266, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 36396.3828125, "policy_loss": -0.11198273301124573, "vf_loss": 36396.484375, "vf_explained_var": 0.4043607711791992, "kl": 0.031236432492733, "entropy": 15.351561546325684, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 204800, "episodes_total": 4336, "training_iteration": 128, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_13-15-46", "timestamp": 1619586946, "time_this_iter_s": 1605.832201719284, "time_total_s": 220049.67962646484, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 11365.291537761688, "timesteps_since_restore": 11200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.80445414847162, "ram_util_percent": 63.47008733624454}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.05730009605634, "episode_reward_min": -1296.108244058224, "episode_reward_mean": -817.2184624234592, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7072.6736956700515, "mean_processing_ms": 666.2908203913684, "mean_inference_ms": 2.21561312931481}, "off_policy_estimator": {}, "info": {"num_steps_trained": 200079, "num_steps_sampled": 206400, "sample_time_ms": 1626123.329, "load_time_ms": 53.133, "grad_time_ms": 823.426, "update_time_ms": 394.04, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 29970.662109375, "policy_loss": -0.10398507863283157, "vf_loss": 29970.763671875, "vf_explained_var": 0.4325989782810211, "kl": 0.0317595973610878, "entropy": 15.346735000610352, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 206400, "episodes_total": 4376, "training_iteration": 129, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_13-43-21", "timestamp": 1619588601, "time_this_iter_s": 1654.204417705536, "time_total_s": 221703.88404417038, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 13019.495955467224, "timesteps_since_restore": 12800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 83.50838983050846, "ram_util_percent": 64.25915254237289}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.05730009605634, "episode_reward_min": -1342.2718568422854, "episode_reward_mean": -829.5031829847751, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7089.201291559625, "mean_processing_ms": 670.737694505892, "mean_inference_ms": 2.2044690750388565}, "off_policy_estimator": {}, "info": {"num_steps_trained": 201630, "num_steps_sampled": 208000, "sample_time_ms": 1636949.547, "load_time_ms": 48.628, "grad_time_ms": 809.038, "update_time_ms": 351.856, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 36990.74609375, "policy_loss": -0.1095181256532669, "vf_loss": 36990.84765625, "vf_explained_var": 0.40944385528564453, "kl": 0.03726060315966606, "entropy": 15.42940902709961, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 208000, "episodes_total": 4408, "training_iteration": 130, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_14-12-05", "timestamp": 1619590325, "time_this_iter_s": 1724.29509973526, "time_total_s": 223428.17914390564, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 14743.791055202484, "timesteps_since_restore": 14400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 84.17417649450996, "ram_util_percent": 65.49719398129321}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.9576996747329, "episode_reward_min": -1342.2718568422854, "episode_reward_mean": -847.5710511423777, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7117.080321967693, "mean_processing_ms": 673.9982337996064, "mean_inference_ms": 2.1970919526583033}, "off_policy_estimator": {}, "info": {"num_steps_trained": 203181, "num_steps_sampled": 209600, "sample_time_ms": 1640720.687, "load_time_ms": 44.987, "grad_time_ms": 796.4, "update_time_ms": 317.736, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 38955.359375, "policy_loss": -0.11485922336578369, "vf_loss": 38955.46484375, "vf_explained_var": 0.4159562885761261, "kl": 0.0326237715780735, "entropy": 15.26547908782959, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 209600, "episodes_total": 4440, "training_iteration": 131, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_14-40-00", "timestamp": 1619592000, "time_this_iter_s": 1675.383811712265, "time_total_s": 225103.5629556179, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 16419.17486691475, "timesteps_since_restore": 16000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.22113855169526, "ram_util_percent": 67.22260359983257}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -392.9576996747329, "episode_reward_min": -1342.2718568422854, "episode_reward_mean": -873.2470489531397, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7145.129044968246, "mean_processing_ms": 672.4011497656472, "mean_inference_ms": 2.1907737735442283}, "off_policy_estimator": {}, "info": {"num_steps_trained": 204732, "num_steps_sampled": 211200, "sample_time_ms": 1638456.331, "load_time_ms": 13.397, "grad_time_ms": 699.18, "update_time_ms": 11.482, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 35203.453125, "policy_loss": -0.11214354634284973, "vf_loss": 35203.55859375, "vf_explained_var": 0.42291459441185, "kl": 0.03407282382249832, "entropy": 15.086284637451172, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 211200, "episodes_total": 4472, "training_iteration": 132, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_15-07-50", "timestamp": 1619593670, "time_this_iter_s": 1669.8820929527283, "time_total_s": 226773.44504857063, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 18089.056959867477, "timesteps_since_restore": 17600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 84.43610411418975, "ram_util_percent": 67.84021830394626}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -395.25731094955114, "episode_reward_min": -1319.8043268559434, "episode_reward_mean": -878.1170799974749, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7178.254012211272, "mean_processing_ms": 675.1262122225106, "mean_inference_ms": 2.1864862384114985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 206283, "num_steps_sampled": 212800, "sample_time_ms": 1658357.724, "load_time_ms": 13.796, "grad_time_ms": 689.325, "update_time_ms": 11.941, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 36993.89453125, "policy_loss": -0.11824808269739151, "vf_loss": 36994.0, "vf_explained_var": 0.44138669967651367, "kl": 0.033776309341192245, "entropy": 15.142037391662598, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 212800, "episodes_total": 4512, "training_iteration": 133, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_15-36-52", "timestamp": 1619595412, "time_this_iter_s": 1741.4702413082123, "time_total_s": 228514.91528987885, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 19830.52720117569, "timesteps_since_restore": 19200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 85.02194041867955, "ram_util_percent": 68.46155394524959}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.3548906238491, "episode_reward_min": -1319.8043268559434, "episode_reward_mean": -862.7596659732349, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7204.115716833346, "mean_processing_ms": 678.036732376539, "mean_inference_ms": 2.183002274139873}, "off_policy_estimator": {}, "info": {"num_steps_trained": 207834, "num_steps_sampled": 214400, "sample_time_ms": 1668158.463, "load_time_ms": 13.747, "grad_time_ms": 694.313, "update_time_ms": 12.208, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 36018.71484375, "policy_loss": -0.12331986427307129, "vf_loss": 36018.8359375, "vf_explained_var": 0.4147685766220093, "kl": 0.03217353671789169, "entropy": 15.065563201904297, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 214400, "episodes_total": 4544, "training_iteration": 134, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_16-05-33", "timestamp": 1619597133, "time_this_iter_s": 1720.9640724658966, "time_total_s": 230235.87936234474, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 21551.491273641586, "timesteps_since_restore": 20800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 85.11466992665036, "ram_util_percent": 69.60908720456398}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -388.75442470205144, "episode_reward_min": -1319.8043268559434, "episode_reward_mean": -814.7256931740096, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7220.920200482376, "mean_processing_ms": 681.9840127542553, "mean_inference_ms": 2.179626857042068}, "off_policy_estimator": {}, "info": {"num_steps_trained": 209385, "num_steps_sampled": 216000, "sample_time_ms": 1669677.175, "load_time_ms": 13.753, "grad_time_ms": 695.061, "update_time_ms": 12.428, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 23899.5546875, "policy_loss": -0.10657334327697754, "vf_loss": 23899.65625, "vf_explained_var": 0.4702777862548828, "kl": 0.031022226437926292, "entropy": 14.807021141052246, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 216000, "episodes_total": 4576, "training_iteration": 135, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_16-32-56", "timestamp": 1619598776, "time_this_iter_s": 1643.4579510688782, "time_total_s": 231879.33731341362, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 23194.949224710464, "timesteps_since_restore": 22400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 84.28890784982936, "ram_util_percent": 70.7092576791809}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -388.75442470205144, "episode_reward_min": -1238.8933425280586, "episode_reward_mean": -795.8374203204183, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7235.100245363356, "mean_processing_ms": 684.1553034579214, "mean_inference_ms": 2.176955603042373}, "off_policy_estimator": {}, "info": {"num_steps_trained": 210936, "num_steps_sampled": 217600, "sample_time_ms": 1672748.107, "load_time_ms": 13.276, "grad_time_ms": 696.598, "update_time_ms": 12.503, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 30657.966796875, "policy_loss": -0.11736679077148438, "vf_loss": 30658.076171875, "vf_explained_var": 0.4435283839702606, "kl": 0.03544376417994499, "entropy": 14.76531982421875, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 217600, "episodes_total": 4608, "training_iteration": 136, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_17-01-24", "timestamp": 1619600484, "time_this_iter_s": 1707.538372516632, "time_total_s": 233586.87568593025, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 24902.487597227097, "timesteps_since_restore": 24000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 84.05964696223316, "ram_util_percent": 71.66395730706076}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -388.75442470205144, "episode_reward_min": -1238.8933425280586, "episode_reward_mean": -801.9318795620793, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7246.6900593889995, "mean_processing_ms": 690.0126866877216, "mean_inference_ms": 2.1744920612635417}, "off_policy_estimator": {}, "info": {"num_steps_trained": 212487, "num_steps_sampled": 219200, "sample_time_ms": 1689344.599, "load_time_ms": 13.343, "grad_time_ms": 713.686, "update_time_ms": 12.309, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 32689.564453125, "policy_loss": -0.11322350054979324, "vf_loss": 32689.669921875, "vf_explained_var": 0.44639232754707336, "kl": 0.03316251561045647, "entropy": 14.748543739318848, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 219200, "episodes_total": 4648, "training_iteration": 137, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_17-30-42", "timestamp": 1619602242, "time_this_iter_s": 1757.9949352741241, "time_total_s": 235344.87062120438, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 26660.48253250122, "timesteps_since_restore": 25600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 84.26665337056242, "ram_util_percent": 72.81364180295174}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.7662594774889, "episode_reward_min": -1320.4499261680512, "episode_reward_mean": -814.303471845105, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7259.453240958184, "mean_processing_ms": 693.2976030488749, "mean_inference_ms": 2.1731752225030796}, "off_policy_estimator": {}, "info": {"num_steps_trained": 214038, "num_steps_sampled": 220800, "sample_time_ms": 1700778.258, "load_time_ms": 13.311, "grad_time_ms": 716.365, "update_time_ms": 12.316, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 33348.91015625, "policy_loss": -0.11709094792604446, "vf_loss": 33349.015625, "vf_explained_var": 0.41139477491378784, "kl": 0.032544005662202835, "entropy": 14.572094917297363, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 220800, "episodes_total": 4680, "training_iteration": 138, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_17-59-22", "timestamp": 1619603962, "time_this_iter_s": 1720.2049582004547, "time_total_s": 237065.07557940483, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 28380.687490701675, "timesteps_since_restore": 27200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 83.35731757032205, "ram_util_percent": 73.87301263758663}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -391.2327045050045, "episode_reward_min": -1320.4499261680512, "episode_reward_mean": -817.4898758836348, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7266.364590696488, "mean_processing_ms": 695.1715857061304, "mean_inference_ms": 2.1722233511965254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 215589, "num_steps_sampled": 222400, "sample_time_ms": 1702406.022, "load_time_ms": 13.302, "grad_time_ms": 717.881, "update_time_ms": 12.946, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 31645.908203125, "policy_loss": -0.10709193348884583, "vf_loss": 31646.005859375, "vf_explained_var": 0.4360012710094452, "kl": 0.028430404141545296, "entropy": 14.447229385375977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 222400, "episodes_total": 4712, "training_iteration": 139, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_18-27-13", "timestamp": 1619605633, "time_this_iter_s": 1670.4957711696625, "time_total_s": 238735.5713505745, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 30051.183261871338, "timesteps_since_restore": 28800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 83.58950902224086, "ram_util_percent": 74.87675199328577}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.6918416464604, "episode_reward_min": -1320.4499261680512, "episode_reward_mean": -842.0951411456041, "episode_len_mean": 47.0, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7274.323885677478, "mean_processing_ms": 693.252790043115, "mean_inference_ms": 2.1706345266948674}, "off_policy_estimator": {}, "info": {"num_steps_trained": 217140, "num_steps_sampled": 224000, "sample_time_ms": 1700734.872, "load_time_ms": 13.582, "grad_time_ms": 717.096, "update_time_ms": 12.449, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 40323.859375, "policy_loss": -0.11114782840013504, "vf_loss": 40323.9609375, "vf_explained_var": 0.41422155499458313, "kl": 0.030751395970582962, "entropy": 14.474308013916016, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 224000, "episodes_total": 4744, "training_iteration": 140, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_18-55-40", "timestamp": 1619607340, "time_this_iter_s": 1707.5781607627869, "time_total_s": 240443.14951133728, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 31758.761422634125, "timesteps_since_restore": 30400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 84.91108829568789, "ram_util_percent": 75.55720739219713}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
{"episode_reward_max": -390.6918416464604, "episode_reward_min": -192151.90650586504, "episode_reward_mean": -2774.735434983513, "episode_len_mean": 47.0, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 7309.679105628333, "mean_processing_ms": 694.1864269041163, "mean_inference_ms": 2.170178138453724}, "off_policy_estimator": {}, "info": {"num_steps_trained": 218691, "num_steps_sampled": 225600, "sample_time_ms": 1866541.133, "load_time_ms": 13.756, "grad_time_ms": 724.76, "update_time_ms": 12.474, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0006000000284984708, "total_loss": 172744720.0, "policy_loss": -0.05763458088040352, "vf_loss": 172744720.0, "vf_explained_var": 0.004756873473525047, "kl": 0.02999282442033291, "entropy": 14.5420503616333, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 1600, "done": false, "timesteps_total": 225600, "episodes_total": 4784, "training_iteration": 141, "experiment_id": "58f74f8d2bc947f8ab2be86cfb39fc53", "date": "2021-04-28_19-51-14", "timestamp": 1619610674, "time_this_iter_s": 3333.5312592983246, "time_total_s": 243776.6807706356, "pid": 3893308, "hostname": "cxteam-sandbox", "node_ip": "192.168.122.169", "config": {"num_workers": 8, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 141, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 47, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"detection_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"num_advanced\": 1,\n            \"num_incoming_edges_per_node\": 4,\n            \"num_measures\": 2,\n            \"num_stopbars\": 3,\n            \"observed_nodes\": [\n                3386,\n                3371,\n                3362,\n                3373\n            ],\n            \"replication_list\": [\n                \"Replication 8050297\",\n                \"Replication 8050315\",\n                \"Replication 8050322\"\n            ],\n            \"statistical_interval\": [\n                0,\n                30,\n                0\n            ],\n            \"target_nodes\": [\n                3369,\n                3341,\n                3370,\n                3344,\n                3329\n            ]\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 17624,\n        \"sims_per_step\": 375,\n        \"warmup_steps\": 1\n    },\n    \"env_name\": \"coordinated_lights.CoordinatedEnv\",\n    \"exp_tag\": \"coordinated_traffic_lights\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {},\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": \"/home/damian/flow/examples/aimsun/traffic_light_coordination/scenario_one_hour.ang\"\n    },\n    \"network\": \"coordinated_lights.CoordinatedNetwork\",\n    \"sim\": {\n        \"centroid_config_name\": \"Centroid Configuration 8040652\",\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"experiment_name\": \"Micro SRC Experiment 867\",\n        \"network_name\": \"Dynamic Scenario 866\",\n        \"pxpm\": 2,\n        \"render\": false,\n        \"replication_name\": \"Replication 8050297\",\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.8,\n        \"subnetwork_name\": null\n    },\n    \"simulator\": \"aimsun\",\n    \"veh\": []\n}", "run": "PPO"}, "env": "CoordinatedEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "lr": 0.0006, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 141, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 35092.29268193245, "timesteps_since_restore": 32000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 53.97576777450568, "ram_util_percent": 77.71194783340344}, "num_healthy_workers": 8, "trial_id": "952a21a8", "experiment_tag": "0"}
